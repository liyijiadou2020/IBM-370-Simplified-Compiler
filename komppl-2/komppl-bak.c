#include <stdio.h>
#include <string.h>
#include <stdbool.h>

#define MAXNISXTXT 50
// #define NSINT     201
#define NSINT     301
#define NCEL       20
#define NDST      500
#define NVXOD      53
#define NSTROKA   200
#define NNETRM     17
#define MAXLTXT    50
#define MAXFORMT   30
#define NSYM      100
#define FILE_NOT_OPEN -2
#define WRITE_FILE_FAILED -2

int idx_of_VXOD(const char* T1, int T2);


FILE* fp_out;               /* Li: Write to ./log.txt */
bool is_cvb = false;
char is_fv;

/*
***** §¢ §Ñ §Ù §Ñ  §Õ§Ñ§ß§ß§í§ç §Ü§à§Þ§á§Ú§Ý§ñ§ä§à§â§Ñ
*/

/*
***** §¢ §Ý §à §Ü  §à§Ò'§ñ§Ó§Ý§Ö§ß§Ú§ñ §Þ§Ñ§ã§ã§Ú§Ó§Ñ §ã §Ú§ã§ç§à§Õ§ß§í§Þ §ä§Ö§Ü§ã§ä§à§Þ
*/

int  NISXTXT;                                     /* §Õ§Ý§Ú§ß§Ñ §Þ§Ñ§ã§ã§Ú§Ó§Ñ          */
char ISXTXT[MAXNISXTXT][80];                      /* §ä§Ö§Ý§à §Þ§Ñ§ã§ã§Ú§Ó§Ñ           */

/*
***** §¢ §Ý §à §Ü  §à§Ò'§ñ§Ó§Ý§Ö§ß§Ú§ñ §â§Ñ§Ò§à§é§Ú§ç §á§Ö§â§Ö§Þ§Ö§ß§ß§í§ç
*/

int I1, I2, I3, I4;                                  /* §ã§é§Ö§ä§é§Ú§Ü§Ú §è§Ú§Ü§Ý§à§Ó        */

char PREDSYM = ' ';                               /*§á§à§ã§Ý§Ö§Õ§ß§Ú§Û §à§Ò§â§Ñ§Ò§à§ä§Ñ§ß§ß§í§Û  */
/*§ã§Ú§Þ§Ó§à§Ý §Ó §å§á§Ý§à§ä§ß§Ö§ß§ß§à§Þ    */
/*§Ú§ã§ç§à§Õ§ß§à§Þ §ä§Ö§Ü§ã§ä§Ö         */

char STROKA[NSTROKA];                          /*§Þ§Ö§ã§ä§à §ç§â§Ñ§ß§Ö§ß§Ú§ñ §å§á§Ý§à§ä§ß§Ö§ß§ß§à§Ô§à §Ú§ã§ç§à§Õ§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ*/

int I, J, K, L;
/* indexs :*/
/* I - §å§á§Ý§à§ä§ß§Ö§ß§ß§à§Þ §ä§Ö§Ü§ã§ä§Ö;  */
/* J - §ä§Ñ§Ò§Ý.§Ô§â§Ñ§Þ§Þ.§á§â§Ñ§Ó§Ú§Ý;   */
/* K - §ã§ä§Ö§Ü§Ö §á§à§ã§ä§Ñ§Ó§Ý§Ö§ß§ß§í§ç §è§Ö§Ý§Ö§Û; */
/* L - §ã§ä§Ö§Ü§Ö §Õ§à§ã§ä§Ú§Ô§ß§å§ä§í§ç §è§Ö§Ý§Ö§Û; */

union  /*§ê§Ñ§Ò§Ý§à§ß §Õ§Ý§ñ §Ô§Ö§ß§Ö§â§Ñ§è§Ú§Ú §Ù§Ñ§á§Ú§ã§Ú §Ó§í§ç§à§Õ§ß§à§Ô§à §æ§Ñ§Û§Ý§Ñ §ß§Ñ §¡§³§³§¦§®§¢§­§¦§²§¦ IBM 370 */
{
  char    BUFCARD[80];
  struct
  {
    char METKA[8];
    char PROB1;
    char OPERAC[5];
    char PROB2;
    char OPERAND[12];
    char PROB3;
    char COMM[52];
  } _BUFCARD;
} ASS_CARD;


char ASSTXT[MAXLTXT][80];                      /*§Þ§Ñ§ã§ã§Ú§Ó §Õ§Ý§ñ §ç§â§Ñ§ß§Ö§ß§Ú§ñ     */
/*§Ó§í§ç§à§Õ§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ §ß§Ñ     */
/*§¡§³§³§¦§®§¢§­§¦§²§¦ IBM 370      */


int  IASSTXT;                                     /*§Ú§ß§Õ§Ö§Ü§ã §Ó§í§ç§à§Õ§ß§à§Ô§à §Þ§Ñ§ã§ã§Ú§Ó§Ñ*/

char FORMT[MAXFORMT][9];                        /*§Þ§Ñ§ã§ã§Ú§Ó §Õ§Ý§ñ §æ§à§â§Þ§Ñ§ä§Ú§â§à§Ó§Ñ§ß-*/
/*§ß§à§Ô§à  (§Ó §Ó§Ú§Õ§Ö §á§à§ã§Ý§Ö§Õ§à§Ó§Ñ-*/
/*§ä§Ö§Ý§î§ß§à§ã§ä§Ú 9-§ä§Ú §á§à§Ù§Ú§è§Ú§à§ß-*/
/*§ß§í§ç §ã§ä§â§à§Ü-§Ý§Ö§Ü§ã§Ö§Þ) §á§â§Ö§Õ- */
/*§ã§ä§Ñ§Ó§Ý§Ö§ß§Ú§ñ §Ú§ß§ä§Ö§â§á§â§Ö§ä§Ú§â§å- */
/*§Ö§Þ§à§Ô§à §æ§â§Ñ§Ô§Þ§Ö§ß§ä§Ñ §Ú§ã§ç§à§Õ§ß§à-*/
/*§Ô§à §á§Ý§à§ä§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ      */

int  IFORMT;                                      /*§Ú§ß§Õ§Ö§Ü§ã §æ§à§â§Þ§Ñ§ä§Ú§â§à§Ó§Ñ§ß§ß§à§Ô§à */
/*§Þ§Ñ§ã§ã§Ú§Ó§Ñ                 */
/*
***** §¢ §Ý §à §Ü  §à§Ò'§ñ§Ó§Ý§Ö§ß§Ú§ñ §ä§Ñ§Ò§Ý§Ú§è §Ò§Ñ§Ù§í §Õ§Ñ§ß§ß§í§ç
*/

/*
***** §´ §Ñ §Ò §Ý §Ú §è §Ñ, §Ú§ã§á§à§Ý§î§Ù§å§Ö§Þ§Ñ§ñ §Ü§Ñ§Ü §Þ§Ñ§Ô§Ñ§Ù§Ú§ß (§ã§ä§Ö§Ü) §Õ§à§ã§ä§Ú§Ø§Ö§ß§Ú§Û
*/

struct
{
  char DST1[4];
  int  DST2;
  int  DST3;
  int  DST4;
  int  DST5;
} DST[NDST];

/*
***** §´ §Ñ §Ò §Ý §Ú §è §Ñ, §Ú§ã§á§à§Ý§î§Ù§å§Ö§Þ§Ñ§ñ §Ü§Ñ§Ü §Þ§Ñ§Ô§Ñ§Ù§Ú§ß (§ã§ä§Ö§Ü) §è§Ö§Ý§Ö§Û
*/

struct
{
  char CEL1[4]; 
  int  CEL2;    
  int  CEL3;    
} CEL[NCEL];

/*
***** §´ §Ñ §Ò §Ý §Ú §è §Ñ, §ã§Ú§ß§ä§Ñ§Ü§ã§Ú§é§Ö§ã§Ü§Ú§ç §á§â§Ñ§Ó§Ú§Ý, §Ù§Ñ§á§Ú§ã§Ñ§ß§ß§í§ç §Ó §æ§à§â§Þ§Ö §â§Ñ§ã§á§à§Ù§ß§Ñ§Ó§Ñ§ß§Ú§ñ,
***** §ã§Ô§â§å§á§á§Ú§â§à§Ó§Ñ§ß§ß§í§ç §Ó "§Ü§å§ã§ä§í" §Ú §á§â§Ö§Õ§ã§ä§Ñ§Ó§Ý§Ö§ß§ß§í§ç §Ó §Ó§Ú§Õ§Ö §Õ§Ó§å§ç§ß§Ñ§á§â§Ó§Ý§Ö§ß§ß§à§Ô§à
***** §ã§á§Ú§ã§Ü§Ñ §ã §Ñ§Ý§î§ä§Ö§â§ß§Ñ§ä§Ú§Ó§ß§í§Þ§Ú §â§Ñ§Ù§Ó§Ö§ä§Ó§Ý§Ö§ß§Ú§ñ§Þ§Ú
*/

struct
{
  int  POSL;    /* §ã§ä§â§å§Ü§ä§å§â§ß§í§Û §Ñ§Õ§â§Ö§ã §á§â§Ñ§Ó§à§Ô§à §ã§Þ§Ö§Ø§ß§à§Ô§à §å§Ù§Ý§Ñ §Ô§â§Ñ§æ§Ñ (§ã§ä§à§Ý§Ò§Ö§è "§á§à§ã§Ý§Ö§Õ§à§Ó§Ñ§ä§Ö§Ý§î" §ã §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§à§Þ POSL)*/
  int  PRED;    /* §ã§ä§â§å§Ü§ä§å§â§ß§í§Û §Ñ§Õ§â§Ö§ã §Ý§Ö§Ó§à§Ô§à §ã§Þ§Ö§Ø§ß§à§Ô§à §å§Ù§Ý§Ñ §Ô§â§Ñ§æ§Ñ (§ã§ä§à§Ý§Ò§Ö§è "§á§â§Ö§Õ§ê§Ö§ã§ä§Ó§Ö§ß§ß§Ú§Ü" §ã §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§à§Þ PRED),*/
  char DER[4];  /* §à§Ò§à§Ù§ß§Ñ§é§Ö§ß§Ú§Ö §ã§Ú§Þ§Ó§à§Ý§Ñ (§ã§ä§à§Ý§Ò§Ö§è "§ã§Ú§Þ§Ó§à§Ý" §ã §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§à§Þ GRAF), §ã§à§Ó§á§Ñ§Õ§Ñ§ð§ë§Ö§Ö §ã§à §Ù§ß§Ñ§é§Ö§ß§Ú§Ö§Þ §ã§Ú§Þ§Ó§à§Ý§Ñ, §å§Ü§Ñ§Ù§Ñ§ß§ß§í§Þ §Ó §Ó§Ö§â§ç§ß§Ö§Û §é§Ñ§ã§ä§Ú §Ú§Ù§à§Ò§â§Ñ§Ø§Ö§ß§Ú§ñ §å§Ù§Ý§Ñ §Ô§â§Ñ§æ§Ñ,*/
  int  ALT;     /* §ã§ä§â§å§Ü§ä§å§â§ß§í§Û §Ñ§Õ§â§Ö§ã §Ñ§Ý§î§ä§Ö§â§ß§Ñ§ä§Ú§Ó§ß§à§Ô§à §å§Ù§Ý§Ñ §Ô§â§Ñ§æ§Ñ (§ã§ä§à§Ý§Ò§Ö§è "§Ñ§Ý§î§ä§Ö§â§ß§Ñ§ä§Ú§Ó§Ñ" §ã §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§à§Þ ALT).*/
} SINT[NSINT] =
/*   __________ _________ _______ _______ ______
    |  NN      :    §á§à§ã§Ý : §á§â§Ö§Õ  :  §Õ§Ö§â  : §Ñ§Ý§î§ä |
    |__________:_________:_______:_______:______|                          */
{
  {/*.    0     .*/    -1 ,    -1 , "***" ,   -1 },
  /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 0      */
 {/*.    1     .*/     2 ,     0 , "0  " ,    0 },
 {/*.    2     .*/     3 ,     1 , "CIF" ,    0 },
 {/*.    3     .*/     0 ,     2 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 1      */
 {/*.    4     .*/     5 ,     0 , "1  " ,    0 },
 {/*.    5     .*/     6 ,     4 , "CIF" ,    7 },
 {/*.    6     .*/     0 ,     5 , "*  " ,    0 },

 {/*.    7     .*/     8 ,     4 , "MAN" ,    0 },
 {/*.    8     .*/     0 ,     7 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 2      */
 {/*.    9     .*/    10 ,     0 , "2  " ,    0 },
 {/*.   10     .*/    11 ,     9 , "CIF" ,    0 },
 {/*.   11     .*/     0 ,    10 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 3      */
 {/*.   12     .*/    13 ,     0 , "3  " ,    0 },
 {/*.   13     .*/    14 ,    12 , "CIF" ,    0 },
 {/*.   14     .*/     0 ,    13 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 4      */
 {/*.   15     .*/    16 ,     0 , "4  " ,    0 },
 {/*.   16     .*/    17 ,    15 , "CIF" ,    0 },
 {/*.   17     .*/     0 ,    16 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 5      */
 {/*.   18     .*/    19 ,     0 , "5  " ,    0 },
 {/*.   19     .*/    20 ,    18 , "CIF" ,    0 },
 {/*.   20     .*/     0 ,    19 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 6      */
 {/*.   21     .*/    22 ,     0 , "6  " ,    0 },
 {/*.   22     .*/    23 ,    21 , "CIF" ,    0 },
 {/*.   23     .*/     0 ,    22 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 7      */
 {/*.   24     .*/    25 ,     0 , "7  " ,    0 },
 {/*.   25     .*/    26 ,    24 , "CIF" ,    0 },
 {/*.   26     .*/     0 ,    25 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 8      */
 {/*.   27     .*/    28 ,     0 , "8  " ,    0 },
 {/*.   28     .*/    29 ,    27 , "CIF" ,    0 },
 {/*.   29     .*/     0 ,    28 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - 9      */
 {/*.   30     .*/    31 ,     0 , "9  " ,    0 },
 {/*.   31     .*/    32 ,    30 , "CIF" ,    0 },
 {/*.   32     .*/     0 ,    31 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - A      */
 {/*.   33     .*/    34 ,     0 , "A  " ,    0 },
 {/*.   34     .*/    35 ,    33 , "BUK" ,    0 },
 {/*.   35     .*/     0 ,    34 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - B      */
 {/*.   36     .*/    37 ,     0 , "B  " ,    0 },
 {/*.   37     .*/    38 ,    36 , "BUK" ,    0 },
 {/*.   38     .*/     0 ,    37 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - C      */
 {/*.   39     .*/    40 ,     0 , "C  " ,    0 },
 {/*.   40     .*/    41 ,    39 , "BUK" ,    0 },
 {/*.   41     .*/     0 ,    40 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - D      */
 {/*.   42     .*/    43 ,     0 , "D  " ,    0 },
 {/*.   43     .*/    44 ,    42 , "BUK" ,   45 },
 {/*.   44     .*/     0 ,    43 , "*  " ,    0 },

 {/*.   45     .*/    46 ,    42 , "C  " ,    0 },
 {/*.   46     .*/    47 ,    45 , "L  " ,    0 },
 {/*.   47     .*/    48 ,    46 , "   " ,    0 },
 {/*.   48     .*/    49 ,    47 , "IDE" ,    0 },
 {/*.   49     .*/    50 ,    48 , "   " ,    0 }, /* tomilin: ancestor DEC*/
 {/*.   50     .*/    51 ,    49 , "B  " ,  187 }, /* tomilin: entry point */
 {/*.   51     .*/    52 ,    50 , "I  " ,    0 },
 {/*.   52     .*/    53 ,    51 , "N  " ,    0 },
 {/*.   53     .*/    54 ,    52 , "   " ,    0 },
 {/*.   54     .*/    55 ,    53 , "F  " ,    0 },
 {/*.   55     .*/    56 ,    54 , "I  " ,    0 },
 {/*.   56     .*/    57 ,    55 , "X  " ,    0 },
 {/*.   57     .*/    58 ,    56 , "E  " ,    0 },
 {/*.   58     .*/    59 ,    57 , "D  " ,    0 },
 {/*.   59     .*/    60 ,    58 , "(  " ,    0 },
 {/*.   60     .*/    61 ,    59 , "RZR" ,    0 },
 {/*.   61     .*/    62 ,    60 , ")  " ,    0 },
 {/*.   62     .*/    63 ,    61 , ";  " ,   65 },
 {/*.   63     .*/    64 ,    62 , "ODC" ,    0 },
 {/*.   64     .*/     0 ,    63 , "*  " ,    0 }, /* ?? successor 65?? was65  */

 {/*.   65     .*/    66 ,    61 , "I  " ,    0 }, /* ?? ancestor 61?? ) */
 {/*.   66     .*/    67 ,    65 , "N  " ,    0 },
 {/*.   67     .*/    68 ,    66 , "I  " ,    0 },
 {/*.   68     .*/    69 ,    67 , "T  " ,    0 },
 {/*.   69     .*/    70 ,    68 , "(  " ,    0 },
 {/*.   70     .*/    71 ,    69 , "LIT" ,    0 },
 {/*.   71     .*/    72 ,    70 , ")  " ,    0 },
 {/*.   72     .*/    73 ,    71 , ";  " ,    0 },
 {/*.   73     .*/   186 ,    72 , "ODC" ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - E      */
 {/*.   74     .*/    75 ,     0 , "E  " ,    0 },
 {/*.   75     .*/    76 ,    74 , "N  " ,   82 },
 {/*.   76     .*/    77 ,    75 , "D  " ,    0 },
 {/*.   77     .*/    78 ,    76 , "   " ,    0 },
 {/*.   78     .*/    79 ,    77 , "IPR" ,    0 },
 {/*.   79     .*/    80 ,    78 , ";  " ,    0 },
 {/*.   80     .*/    81 ,    79 , "OEN" ,    0 },
 {/*.   81     .*/     0 ,    80 , "*  " ,    0 },

 {/*.   82     .*/    83 ,    74 , "BUK" ,    0 },
 {/*.   83     .*/     0 ,    82 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - M      */
 {/*.   84     .*/    85 ,     0 , "M  " ,    0 },
 {/*.   85     .*/    86 ,    84 , "BUK" ,    0 },
 {/*.   86     .*/     0 ,    85 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - P      */
 {/*.   87     .*/    88 ,     0 , "P  " ,    0 },
 {/*.   88     .*/    89 ,    87 , "BUK" ,    0 },
 {/*.   89     .*/     0 ,    88 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - X      */
 {/*.   90     .*/    91 ,     0 , "X  " ,    0 },
 {/*.   91     .*/    92 ,    90 , "BUK" ,    0 },
 {/*.   92     .*/     0 ,    91 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - BUK    */
 {/*.   93     .*/    94 ,     0 , "BUK" ,    0 },
 {/*.   94     .*/    95 ,    93 , "IDE" ,    0 },
 {/*    95     .*/     0 ,    94 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - IDE    */
 {/*.   96     .*/    97 ,     0 , "IDE" ,    0 },
 {/*.   97     .*/    98 ,    96 , "BUK" ,  100 },
 {/*.   98     .*/    99 ,    97 , "IDE" ,    0 },
 {/*.   99     .*/     0 ,    98 , "*  " ,    0 },

 {/*.  100     .*/   101 ,    96 , "CIF" ,  103 },
 {/*.  101     .*/   102 ,   100 , "IDE" ,    0 },
 {/*.  102     .*/     0 ,   101 , "*  " ,    0 },

 {/*.  103     .*/   104 ,    96 , "IPE" ,  105 },
 {/*.  104     .*/     0 ,   103 , "*  " ,    0 },

 {/*.  105     .*/   106 ,    96 , "IPR" ,    0 },
 {/*.  106     .*/     0 ,   105 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - +      */
 {/*.  107     .*/   108 ,     0 , "+  " ,    0 },
 {/*.  108     .*/   109 ,   107 , "ZNK" ,    0 },
 {/*.  109     .*/     0 ,   108 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - -      */
 {/*.  110     .*/   111 ,     0 , "-  " ,    0 },
 {/*.  111     .*/   112 ,   110 , "ZNK" ,    0 },
 {/*.  112     .*/     0 ,   111 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - IPR    */
 {/*.  113     .*/   114 ,     0 , "IPR" ,    0 },
 {/*.  114     .*/   115 ,   113 , ":  " ,    0 },
 {/*.  115     .*/   116 ,   114 , "P  " ,    0 },
 {/*.  116     .*/   117 ,   115 , "R  " ,    0 },
 {/*.  117     .*/   118 ,   116 , "O  " ,    0 },
 {/*.  118     .*/   119 ,   117 , "C  " ,    0 },
 {/*.  119     .*/   120 ,   118 , "   " ,    0 },
 {/*.  120     .*/   121 ,   119 , "O  " ,    0 },
 {/*.  121     .*/   122 ,   120 , "P  " ,    0 },
 {/*.  122     .*/   123 ,   121 , "T  " ,    0 },
 {/*.  123     .*/   124 ,   122 , "I  " ,    0 },
 {/*.  124     .*/   125 ,   123 , "O  " ,    0 },
 {/*.  125     .*/   126 ,   124 , "N  " ,    0 },
 {/*.  126     .*/   127 ,   125 , "S  " ,    0 },
 {/*.  127     .*/   128 ,   126 , "(  " ,    0 },
 {/*.  128     .*/   129 ,   127 , "M  " ,    0 },
 {/*.  129     .*/   130 ,   128 , "A  " ,    0 },
 {/*.  130     .*/   131 ,   129 , "I  " ,    0 },
 {/*.  131     .*/   132 ,   130 , "N  " ,    0 },
 {/*.  132     .*/   133 ,   131 , ")  " ,    0 },
 {/*.  133     .*/   134 ,   132 , ";  " ,    0 },
 {/*.  134     .*/   135 ,   133 , "OPR" ,    0 },
 {/*.  135     .*/     0 ,   134 , "*  " ,    0 },
 /*                                                §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - CIF    */
 {/*.  136     .*/   137 ,     0 , "CIF" ,    0 },
 {/*.  137     .*/   138 ,   136 , "RZR" ,  234 }, /* tomilin: entry point */ /*Li: must be 234*/
 {/*.  138     .*/     0 ,   137 , "*  " ,    0 }, /* ancestor was 0 */
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - RZR    */
 {/*.  139     .*/   140 ,     0 , "RZR" ,    0 },
 {/*.  140     .*/   141 ,   139 , "CIF" ,    0 },
 {/*.  141     .*/   142 ,   140 , "RZR" ,    0 },
 {/*.  142     .*/     0 ,   141 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - MAN    */
 {/*.  143     .*/   144 ,     0 , "MAN" ,    0 },
 {/*.  144     .*/   145 ,   143 , "B  " ,  147 },
 {/*.  145     .*/   146 ,   144 , "LIT" ,    0 },
 {/*.  146     .*/     0 ,   145 , "*  " ,    0 },

 {/*.  147     .*/   148 ,   143 , "0  " ,  150 },
 {/*.  148     .*/   149 ,   147 , "MAN" ,    0 },
 {/*.  149     .*/     0 ,   148 , "*  " ,    0 },

 {/*.  150     .*/   151 ,   143 , "1  " ,    0 },
 {/*.  151     .*/   152 ,   150 , "MAN" ,    0 },
 {/*.  152     .*/     0 ,   151 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - IPE    */
 {/*.  153     .*/   154 ,     0 , "IPE" ,    0 },
 {/*.  154     .*/   155 ,   153 , "=  " ,  159 },
 {/*.  155     .*/   156 ,   154 , "AVI" ,    0 },
 {/*.  156     .*/   157 ,   155 , ";  " ,    0 },
 {/*.  157     .*/   158 ,   156 , "OPA" ,    0 },
 {/*.  158     .*/     0 ,   157 , "*  " ,    0 },

 {/*.  159     .*/   160 ,   153 , "AVI" ,    0 },
 {/*.  160     .*/     0 ,   159 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - LIT    */
 {/*.  161     .*/   162 ,     0 , "LIT" ,    0 },
 {/*.  162     .*/   163 ,   161 , "AVI" ,    0 },
 {/*.  163     .*/     0 ,   162 , "*  " ,    0 },
 /*.                                              §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - AVI    */
 {/*.  164     .*/   165 ,     0 , "AVI" ,    0 },
 {/*.  165     .*/   166 ,   164 , "ZNK" ,    0 },
 {/*.  166     .*/   167 ,   165 , "LIT" ,  168 },
 {/*.  167     .*/   197 ,   166 , "AVI" ,    0 },

 {/*.  168     .*/   169 ,   165 , "IPE" ,    0 },
 {/*.  169     .*/   170 ,   168 , "AVI" ,    0 },
 {/*.  170     .*/     0 ,   169 , "*  " ,    0 },
 /*                                               §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - OPR    */
 {/*.  171     .*/   172 ,     0 , "OPR" ,    0 },
 {/*.  172     .*/   173 ,   171 , "TEL" ,    0 },
 {/*.  173     .*/   174 ,   172 , "OEN" ,    0 },
 {/*.  174     .*/   175 ,   173 , "PRO" ,    0 },
 {/*.  175     .*/     0 ,   174 , "*  " ,    0 },
 /*.                                              §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - ODC    */
 {/*.  176     .*/   177 ,     0 , "ODC" ,    0 },
 {/*.  177     .*/   178 ,   176 , "TEL" ,    0 },
 {/*.  178     .*/     0 ,   177 , "*  " ,    0 },
 /*.                                              §Ó§ç§à§Õ §ã §ã§Ú§Þ§Ó§à§Ý§Ñ - TEL    */
 {/*.  179     .*/   180 ,     0 , "TEL" ,    0 },
 {/*.  180     .*/   181 ,   179 , "ODC" ,  183 },
 {/*.  181     .*/   182 ,   180 , "TEL" ,    0 },
 {/*.  182     .*/     0 ,   181 , "*  " ,    0 },

 {/*.  183     .*/   184 ,   179 , "OPA" ,    0 },
 {/*.  184     .*/   185 ,   183 , "TEL" ,    0 },
 {/*.  185     .*/     0 ,   184 , "*  " ,    0 },

 {/*.  186     .*/     0 ,    73 , "*  " ,    0 },

 {/*.  187     .*/   188 ,    49 , "C  " ,  201 }, /* tomilin: entry point */
 {/*.  188     .*/   189 ,   187 , "H  " ,    0 },
 {/*.  189     .*/   190 ,   188 , "A  " ,    0 },
 {/*.  190     .*/   191 ,   189 , "R  " ,    0 },
 {/*.  191     .*/   192 ,   190 , "(  " ,    0 },
 {/*.  192     .*/   193 ,   191 , "RZR" ,    0 },
 {/*.  193     .*/   194 ,   192 , ")  " ,    0 },
 {/*.  194     .*/   195 ,   193 , ";  " ,    0 },
 {/*.  195     .*/   196 ,   194 , "ODC" ,    0 },
 {/*.  196     .*/     0 ,   195 , "*  " ,    0 },

 {/*.  197     .*/     0 ,   167 , "*  " ,    0 },

 {/*.  198     .*/   199 ,     0 , "*  " ,    0 },
 {/*.  199     .*/   200 ,   198 , "ZNK" ,    0 },
 {/*.  200     .*/     0 ,   199 , "*  " ,    0 },

 {/*.  201     .*/   202 ,    49 , "D  " ,  221 }, /* tomilin: DEC_FIXED... */
 {/*.  202     .*/   203 ,   201 , "E  " ,    0 },
 {/*.  203     .*/   204 ,   202 , "C  " ,    0 },
 {/*.  204     .*/   205 ,   203 , "   " ,    0 },
 {/*.  205     .*/   206 ,   204 , "F  " ,    0 },
 {/*.  206     .*/   207 ,   205 , "I  " ,    0 },
 {/*.  207     .*/   208 ,   206 , "X  " ,    0 },
 {/*.  208     .*/   209 ,   207 , "E  " ,    0 },
 {/*.  209     .*/   210 ,   208 , "D  " ,    0 },
 {/*.  210     .*/   211 ,   209 , "   " ,    0 },
 {/*.  211     .*/   212 ,   210 , "I  " ,    0 },
 {/*.  212     .*/   213 ,   211 , "N  " ,    0 },
 {/*.  213     .*/   214 ,   212 , "I  " ,    0 },
 {/*.  214     .*/   215 ,   213 , "T  " ,    0 },
 {/*.  215     .*/   216 ,   214 , "(  " ,    0 },
 {/*.  216     .*/   217 ,   215 , "DCF" ,    0 },
 {/*.  217     .*/   218 ,   216 , ")  " ,    0 },
 {/*.  218     .*/   219 ,   217 , ";  " ,    0 },
 {/*.  219     .*/   220 ,   218 , "ODC" ,    0 },
 {/*.  220     .*/     0 ,   219 , "*  " ,    0 },

 {/*.  221     .*/   222 ,    49 , "B  " ,    0 }, /* tomilin: BIT(INIT... */
 {/*.  222     .*/   223 ,   221 , "I  " ,    0 },
 {/*.  223     .*/   224 ,   222 , "T  " ,    0 },
 {/*.  224     .*/   225 ,   223 , "(  " ,    0 },
 {/*.  225     .*/   226 ,   224 , "RZR" ,    0 },
 {/*.  226     .*/   227 ,   225 , ")  " ,    0 },
 {/*.  227     .*/   228 ,   226 , ";  " ,    0 },
 {/*.  228     .*/   229 ,   227 , "ODC" ,    0 },
 {/*.  229     .*/     0 ,   228 , "*  " ,    0 },

 {/*.  230     .*/   231 ,     0 , "DCF" ,    0 }, /* tomilin: DEC_FIXED... */
 {/*.  231     .*/   232 ,   230 , "CIF" ,    0 },
 {/*.  232     .*/   233 ,   231 , "DCF" ,    0 },
 {/*.  233     .*/     0 ,   232 , "*  " ,    0 },

 {/*.  234     .*/   235 ,   136 , "DCF" ,  231 }, /* tomilin: DEC_FIXED... */ /* Li: alt was 0*/
 {/*.  235     .*/     0 ,   234 , "*  " ,    0 }
};


/*
***** §´§Ñ§Ò§Ý§Ú§è§Ñ  §Ó§ç§à§Õ§à§Ó §Ó "§Ü§å§ã§ä§í" ( §Ü§à§â§ß§Ö§Û )§Ô§â§Ñ§Þ§Þ§Ñ§ä§Ú§é§Ö§ã§Ü§Ú§ç §á§â§Ñ§Ó§Ú§Ý,
***** §ã§à§Õ§Ö§â§Ø§Ñ§ë§Ñ§ñ §ä§Ú§á ( §ä§Ö§â§Þ§Ú§ß§Ñ§Ý§î§ß§à§ã§ä§î §Ú§Ý§Ú §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§î§ß§à§ã§ä§î ) §Ü§à§â§ß§Ö§Ó§í§ç
***** §ã§Ú§Þ§Ó§à§Ý§à§Ó
*/

struct
{
  char SYM[4];
  int  VX;
  char TYP;
} VXOD[NVXOD] =
/*   __________ ___________ _____ ______
    |  NN      |    §ã§Ú§Þ§Ó§à§Ý | §Ó§ç§à§Õ| §ä§Ú§á  |
    |__________|___________|_____|______|                                  */

{
  {/*.   1     .*/   "AVI" , 164 , 'N' },
  {/*.   2     .*/   "BUK" ,  93 , 'N' },
  {/*.   3     .*/   "CIF" , 136 , 'N' },
  {/*.   4     .*/   "IDE" ,  96 , 'N' },
  {/*.   5     .*/   "IPE" , 153 , 'N' },
  {/*.   6     .*/   "IPR" , 113 , 'N' },
  {/*.   7     .*/   "LIT" , 161 , 'N' },
  {/*.   8     .*/   "MAN" , 143 , 'N' },
  {/*.   9     .*/   "ODC" , 176 , 'N' },
  {/*.  10     .*/   "OEN" ,   0 , 'N' },
  {/*.  11     .*/   "OPA" ,   0 , 'N' },
  {/*.  12     .*/   "OPR" , 171 , 'N' },
  {/*.  13     .*/   "PRO" ,   0 , 'N' },
  {/*.  14     .*/   "RZR" , 139 , 'N' },
  {/*.  15     .*/   "TEL" , 179 , 'N' },
  {/*.  16     .*/   "ZNK" ,   0 , 'N' },
  {/*.  17     .*/   "DCF" , 234 , 'N' },
  {/*.  18     .*/   "A  " ,  33 , 'T' },
  {/*.  19     .*/   "B  " ,  36 , 'T' },
  {/*.  20     .*/   "C  " ,  39 , 'T' },
  {/*.  21     .*/   "D  " ,  42 , 'T' },
  {/*.  22     .*/   "E  " ,  74 , 'T' },
  {/*.  23     .*/   "M  " ,  84 , 'T' },
  {/*.  24     .*/   "P  " ,  87 , 'T' },
  {/*.  25     .*/   "X  " ,  90 , 'T' },
  {/*.  26     .*/   "0  " ,   1 , 'T' },
  {/*.  27     .*/   "1  " ,   4 , 'T' },
  {/*.  28     .*/   "2  " ,   9 , 'T' },
  {/*.  29     .*/   "3  " ,  12 , 'T' },
  {/*.  30     .*/   "4  " ,  15 , 'T' },
  {/*.  31     .*/   "5  " ,  18 , 'T' },
  {/*.  32     .*/   "6  " ,  21 , 'T' },
  {/*.  33     .*/   "7  " ,  24 , 'T' },
  {/*.  34     .*/   "8  " ,  27 , 'T' },
  {/*.  35     .*/   "9  " ,  30 , 'T' },
  {/*.  36     .*/   "+  " , 107 , 'T' },
  {/*.  37     .*/   "-  " , 110 , 'T' },
  {/*.  38     .*/   ":  " ,   0 , 'T' },
  {/*.  39     .*/   "I  " ,   0 , 'T' },
  {/*.  40     .*/   "R  " ,   0 , 'T' },
  {/*.  41     .*/   "N  " ,   0 , 'T' },
  {/*.  42     .*/   "O  " ,   0 , 'T' },
  {/*.  43     .*/   "T  " ,   0 , 'T' },
  {/*.  44     .*/   "S  " ,   0 , 'T' },
  {/*.  45     .*/   "(  " ,   0 , 'T' },
  {/*.  46     .*/   ")  " ,   0 , 'T' },
  {/*.  47     .*/   "   " ,   0 , 'T' },
  {/*.  48     .*/   ";  " ,   0 , 'T' },
  {/*.  49     .*/   "L  " ,   0 , 'T' },
  {/*.  50     .*/   "F  " ,   0 , 'T' },
  {/*.  51     .*/   "=  " ,   0 , 'T' },
  {/*.  52     .*/   "H  " ,   0 , 'T' },
  {/*.  53     .*/   "*  " , 198 , 'T' }
};


/*
***** §´ §Ñ §Ò §Ý §Ú §è §Ñ  §Þ§Ñ§ä§â§Ú§è§í §ã§Þ§Ö§Ø§ß§à§ã§ä§Ú - §à§ã§ß§à§Ó§Ñ §á§à§ã§ä§â§à§Ö§ß§Ú§ñ §Þ§Ñ§ä§â§Ú§è§í
***** §á§â§Ö§Ö§Þ§ß§Ú§Ü§à§Ó
*/
char TPR[NVXOD][NNETRM] =
{
  /*
     __________ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___
    |       AVI:BUK:CIF:IDE:IPE:IPR:LIT:MAN:ODC:OEN:OPA:OPR:PRO:RZR:TEL:ZNK:DCF|
    |__________:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___| */
    {/*AVI*/ 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*BUK*/ 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*CIF*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 1 },
    {/*IDE*/ 0 , 0 , 0 , 1 , 1 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*IPE*/ 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*IPR*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 },
    {/*LIT*/ 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*MAN*/ 0 , 0 , 0 , 0 , 0 , 0 , 1 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*ODC*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 },
    {/*OEN*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*OPA*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*OPR*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 },
    {/*PRO*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*RZR*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 },
    {/*TEL*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 },
    {/*ZNK*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    {/*DCF*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
    /*
       __________ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___
      |       AVI:BUK:CIF:IDE:IPE:IPR:LIT:MAN:ODC:OEN:OPA:OPR:PRO:RZR:TEL:ZNK:DCF|
      |__________:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___| */
      {/*  A*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  B*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  C*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  D*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  E*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  M*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  P*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  X*/ 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  0*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  1*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  2*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  3*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  4*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      {/*  5*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 },
      {/*  6*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 },
      {/*  7*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
      /*
         __________ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___
        |       AVI:BUK:CIF:IDE;IPE:IPR:LIT:MAN:ODC:OEN:OPA:OPR:PRO:RZR:TEL:ZNK:DCF|
        |__________:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___| */
        {/*  8*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  9*/ 0 , 0 , 1 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  +*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 },
        {/*  -*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1 , 0 },
        {/*  :*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  I*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  R*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  N*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  O*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  T*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  S*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  (*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  )*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  ;*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*   */ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        {/*  L*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 },
        /*
          __________ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___ ___
        |       AVI:BUK:CIF:IDE:IPE:IPR:LIT:MAN:ODC:OEN;OPA:OPR:PR0:RZR:TEL:ZNK:DCF|
        |__________:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___:___| */
        {/*  F*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0, 0 },
        {/*  =*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0, 0 },
        {/*  H*/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0, 0 },
        {/*  **/ 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 0 , 1, 0 }
        /*|__________________________________________________________________________| */
};




/*..........................................................................*/

struct              /* §ä§Ñ§Ò§Ý§Ú§è§Ñ §Ú§Þ§Ö§ß §Þ§Ö§ä§à§Ü §Ú   */
{                  /* §á§Ö§â§Ö§Þ§Ö§ß§ß§í§ç, §Ù§Ñ§á§à§Ý§ß§ñ§Ö§Þ§Ñ§ñ*/
  char NAME[8];    /* §ß§Ñ §á§Ö§â§Ó§à§Þ §á§â§à§ç§à§Õ§Ö §ã§Ö-  */
  char TYPE;        /* §Þ§Ñ§ß§ä§Ú§é§Ö§ã§Ü§à§Ô§à §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ*/
  char RAZR[5];    /* §Ú §Ú§ã§á§à§Ý§î§Ù§å§Ö§Þ§Ñ§ñ §ß§Ñ §Ó§ä§à- */
  char INIT[50];   /* §â§à§Þ §á§â§à§ç§à§Õ§Ö §ã§Ö§Þ§Ñ§ß§ä§Ú§é§Ö§ã§Ü§à§Ô§à §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ*/
} SYM[NSYM];

int ISYM = 0;       /* §ä§Ö§Ü§å§ë§Ú§Û §Ú§ß§Õ§Ö§Ü§ã §ä§Ñ§Ò§Ý§Ú§è§í §Ú§Þ§Ö§ß*/

char NFIL[30] = "\x0";   /* §ç§â§Ñ§ß§Ú§Ý§Ú§ë§Ö §Ú§Þ§Ö§ß§Ú §ä§â§Ñ§ß§ã§Ý§Ú§â§å§Ö§Þ§à§Û §á§â§à§Ô§â§Ñ§Þ§Þ§í     */




/*..........................................................................*/

char* getDateTime()
{
  static char nowtime[20];
  time_t rawtime;
  struct tm* ltime;
  time(&rawtime);
  ltime = localtime(&rawtime);
  strftime(nowtime, 20, "%Y-%m-%d %H:%M:%S", ltime);
  return nowtime;
}

void print_title_log() {
  char* nowtime = getDateTime();
  fprintf(fp_out, "\n\n\n\n\n\n PROGRAM START...\n//////////////////////////////////////////////////////////////////////\n");
  fprintf(fp_out, "////////////////////////////////////////// %s ///////\n", nowtime);
  fprintf(fp_out, "//////////////////////////////////////////////////////////////////////\n\n");
  fflush(fp_out);
}


void print_ASSTXT_to_file() {
  fprintf(fp_out, "\n%s \n", "SYNTAX ANALYZE FINISHED! NOW PRINTING IASSTXT... ");

  fprintf(fp_out, "%s\n", "--------- ASS ---------> \n");
  for (int i = 0; i < IASSTXT; i++) {
    fprintf(fp_out, "%d\t%s\n", i + 1, ASSTXT[i]);
  }
  fprintf(fp_out, "\n%s\n", "<------------ASS ------\n");
  fflush(fp_out);
}

void print_DST() {
  fprintf(fp_out, "%s\n", "---> print DST stack:");
  for (int i = 0; i < L; i++) {

    int tmp = 0;
    tmp = idx_of_VXOD(DST[i].DST1, 3);
    fprintf(fp_out,
      ">>(%d/%d)\t\t%s\t\t%d\t\t%d\t\t%d\t\t%d\n",
      i, L,
      DST[i].DST1,
      DST[i].DST2,
      DST[i].DST3,
      DST[i].DST4,
      DST[i].DST5);
  }
  fprintf(fp_out, "%s\n\n", "<----");
  fflush(fp_out);
}

void print_error_message_of_COD(int result_gen_COD) {
  switch (result_gen_COD)                         /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é§Ö§ã§Ü§à§Ö §Ó§í§é§Ú§ã§Ý§Ö§ß.*/
  {
  case  1:                                    /*§Ö§ã§Ý§Ú §Ü§à§Õ §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§ñ = 1,*/
    printf("%s\n",                           /* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö;*/
      "Name of product doesn't fix.");
    break;                                     /* - §Ó§í§Û§ä§Ú §ß§Ñ §à§Ò§à§Ò§ë§Ñ§ð§ë§å§ð  *//* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö; §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å             */
  case  2:                                    /*§Ö§ã§Ý§Ú §Ü§à§Õ §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§ñ = 2,*/
    /* §ä§à:                    */
    STROKA[DST[I2].DST2 + 20] = '\x0';      /* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö;*/
    printf("%s%s\n%s%s%s\n",
      "Type of identifier not allow: ",
      &FORMT[1], " §Ó §Ú§ã§ç.§ä§Ö§Ü§ã§ä§Ö -> \"...",
      &STROKA[DST[I2].DST2], "...\"");
    break;                                     /* - §Ó§í§Û§ä§Ú §ß§Ñ §à§Ò§à§Ò§ë§Ñ§ð§ë§å§ð §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å             */
  case  3:                                    /*§Ö§ã§Ý§Ú §Ü§à§Õ §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§ñ = 3,*/
    /* §ä§à:                    */
    STROKA[DST[I2].DST2 + 20] = '\x0';     /* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö;*/
    printf("%s%s\n%s%s%s\n",
      "Type of identifier not allow_2",
      &FORMT[IFORMT - 1], " §Ó §Ú§ã§ç.§ä§Ö§Ü§ã§ä§Ö -> \"...",
      &STROKA[DST[I2].DST2], "...\"");
    break;                                     /* -§Ó§í§Û§ä§Ú §ß§Ñ §à§Ò§à§Ò§ë§Ñ§ð§ë§å§ð  §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å */
  case  4:                                    /*§Ö§ã§Ý§Ú §Ü§à§Õ §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§ñ = 4,*/
    /* §ä§à:                    */
    STROKA[DST[I2].DST2 + 20] = '\x0';     /* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö;*/
    printf("%s%s\n%s%s%s\n",
      "Undefined identifier: ",
      &FORMT[IFORMT - 1], " §Ó §Ú§ã§ç.§ä§Ö§Ü§ã§ä§Ö -> \"...",
      &STROKA[DST[I2].DST2], "...\"");
    break;                                     /* - §Ó§í§Û§ä§Ú §ß§Ñ §à§Ò§à§Ò§ë§Ñ§ð§ë§å§ð §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å */
  case  5:                                    /*§Ö§ã§Ý§Ú §Ü§à§Õ §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§ñ = 5,*/
    STROKA[DST[I2].DST2 + 20] = '\x0';     /* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö;*/
    printf("%s%c\n%s%s%s\n",
      "Undefined operation: ",
      STROKA[DST[I2].DST4 - strlen(FORMT[IFORMT - 1])],
      " ERROR HERE -> \"...", &STROKA[DST[I2].DST2], "...\"");
    break;                                     /* - §Ó§í§Û§ä§Ú §ß§Ñ §à§Ò§à§Ò§ë§Ñ§ð§ë§å§ð §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å */
  case  6:                                    /*§Ö§ã§Ý§Ú §Ü§à§Õ §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§ñ = 6 */
    STROKA[DST[I2].DST2 + 20] = '\x0';     /* - §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§é.§ã§à§à§Ò§ë§Ö§ß§Ú§Ö;*/
    printf("%s%s\n%s%s%s\n",
      "Identifier re-declared: ",
      &FORMT[1], " ERROR HERE -> \"...",
      &STROKA[DST[I2].DST2], "...\"");
    break;                                     /* - §Ó§í§Û§ä§Ú §ß§Ñ §à§Ò§à§Ò§ë§Ñ§ð§ë§å§ð §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å */
  }
}

void print_error_code(int return_code) {
  STROKA[I4 + 20] = '\x0';
  fprintf(fp_out, "[ERROR] CODE: %d\n", return_code);
  fprintf(fp_out, "%s%s%s%s\n", "[ERROR INFO] Syntax error here-> ", "\"...", &STROKA[I4], "...\"");
  printf("%s\n", "ERROR.");
}


/*..........................................................................*/

void compress_ISXTXT()
{
  //fprintf(fp_out, "---> %s\n", "void compress_ISXTXT()");
  //fflush(fp_out);

  I3 = 0;
  for (I1 = 0; I1 < NISXTXT; I1++)
  {
    for (I2 = 0; I2 < 80; I2++)
      if (ISXTXT[I1][I2] != '\x0')
      {
        if (ISXTXT[I1][I2] == ' ' &&
          (PREDSYM == ' ' || PREDSYM == ';' ||
            PREDSYM == ')' || PREDSYM == ':' ||
            PREDSYM == '('
            )
          )
        {
          PREDSYM = ISXTXT[I1][I2];
          goto L2;
        }

        if
          (
            (ISXTXT[I1][I2] == '+' ||
              ISXTXT[I1][I2] == '-' ||
              ISXTXT[I1][I2] == '=' ||
              ISXTXT[I1][I2] == '(' ||
              ISXTXT[I1][I2] == ')' ||
              ISXTXT[I1][I2] == '*'
              )
            &&
            PREDSYM == ' '
            )
        {
          I3--;
          goto L1;
        }


        if (ISXTXT[I1][I2] == ' ' &&
          (PREDSYM == '+' || PREDSYM == '-' ||
            PREDSYM == '=' || PREDSYM == '*'
            )
          )
        {
          goto L2;
        }

      L1:
        PREDSYM = ISXTXT[I1][I2];
        STROKA[I3] = PREDSYM;
        I3++;

      L2:    continue;
      }
      else
        break;
  }
  STROKA[I3] = '\x0';

  fprintf(fp_out, "Text after compress:\n%s\n\n", STROKA);
  fflush(fp_out);

}

/*..........................................................................*/


void build_TPR()
{
  //fprintf(fp_out, "---> %s\n", "void build_TPR()");
  //fflush(fp_out);

  for (I1 = 0; I1 < NNETRM; I1++)
  {
    for (I2 = 0; I2 < NVXOD; I2++)
    {
      if (TPR[I2][I1] & (I1 != I2))
      {
        for (I3 = 0; I3 < NNETRM; I3++)
          TPR[I2][I3] |= TPR[I1][I3];
      }
    }
  }
}

/*..........................................................................*/

void mcel(const char* T1, int T2, int T3)
{
  strcpy(CEL[K].CEL1, T1);
  CEL[K].CEL2 = T2;
  CEL[K].CEL3 = T3;
  K++;
}

/*..........................................................................*/

void mdst(char* T1, int T2, int T3, int T4, int T5)
{
  strcpy(DST[L].DST1, T1);
  DST[L].DST2 = T2;
  DST[L].DST3 = T3;
  DST[L].DST4 = T4;
  DST[L].DST5 = T5;
  L++;
}



/*..........................................................................*/              
int idx_of_VXOD(const char* T1, int T2)
{
  int k;

  for (I1 = 0; I1 < NVXOD; I1++)
  {
    for (k = 0; k < T2; k++)
    {
      if ((*(T1 + k) != VXOD[I1].SYM[k]))
        goto numb1;
    }
    if ((VXOD[I1].SYM[k] == '\x0') || (VXOD[I1].SYM[k] == ' '))
      return (I1);
  numb1:
    continue;
  }
  return -1;
}

/*..........................................................................*/

int sint_ANAL()
{
  //fprintf(fp_out, "---> %s\n", "int sint_ANAL()");
  //fflush(fp_out);

  I4 = 0;
  /* ³õÊ¼»¯£¨§ß§Ñ§é§Ñ§Ý§î§ß§í§ç §å§ã§ä§Ñ§ß§à§Ó§à§Ü£©*/
L1:

  K = 0;
  L = 0;
  I = 0;
  J = 1;
  mcel("PRO", I, 999);

  if (!TPR[idx_of_VXOD(&STROKA[I], 1)][idx_of_VXOD("PRO", 3)])
    return 1;
  /* §á§â§à§Ö§è§Ú§â§à§Ó§Ñ§ß§Ú§ñ §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ §á§à §Ó§í§Ò§â§Ñ§ß§ß§à§Û §Ô§Ú§á§à§ä§Ö§Ù§Ö */
L2: /*§£§ç§à§Õ §Ó §Ô§â§Ñ§æ */

  J = VXOD[idx_of_VXOD(&STROKA[I], 1)].VX;

L3: /* §±§â§à§Ó§Ö§â§Ü§Ñ §ä§Ö§â§Þ. 1 */

  J = SINT[J].POSL;

L31:

  I++; //? J++?

  if (I > I4)
    I4 = I;

  if (VXOD[idx_of_VXOD(SINT[J].DER, 3)].TYP == 'T')
  {
    if (STROKA[I] == SINT[J].DER[0])
      goto L3;
    else
      goto L8;
  }
  /* §¢§Ý§à§Ü §à§Ò§â§Ñ§Ò§à§ä§Ü§Ú §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§à§Ó */
L4:
  if (SINT[SINT[J].POSL].DER[0] == '*')
  {
    I--;

    if (!strcmp(SINT[J].DER, CEL[K - 1].CEL1))
    { // §¢§Ý§à§Ü §à§Ò§â§Ñ§Ò§à§ä§Ü§Ú §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§à§Ó (§á§â§à§Õ§à§Ý§Ø§Ö§ß§Ú§Ö)
      mdst(CEL[K - 1].CEL1, CEL[K - 1].CEL2, CEL[K - 1].CEL3, I, J);
      if (!strcmp(CEL[K - 1].CEL1, "PRO"))
        return 0;
    L5:
      if (TPR[idx_of_VXOD(CEL[K - 1].CEL1, 3)][idx_of_VXOD(CEL[K - 1].CEL1, 3)]) {
        J = VXOD[idx_of_VXOD(CEL[K - 1].CEL1, 3)].VX;
        goto L3;
      }

    L6:
      J = CEL[K - 1].CEL3;
      K--;
      goto L3;
    }

    if (!TPR[idx_of_VXOD(SINT[J].DER, 3)][idx_of_VXOD(CEL[K - 1].CEL1, 3)])
      goto L9; // §°§Ò§â§Ñ§ä§ß§í§Û §á§à§Ú§ã§Ü 2

    mdst(SINT[J].DER, CEL[K - 1].CEL2, 0, I, J);
    J = VXOD[idx_of_VXOD(SINT[J].DER, 3)].VX;
    goto L3;
  }

  if (!TPR[idx_of_VXOD(&STROKA[I], 1)][idx_of_VXOD(SINT[J].DER, 3)])
    goto L8;

  mcel(SINT[J].DER, I, J);
  goto L2;

L8: /*§±§â§à§Ó§Ö§â§Ü§Ñ §ä§Ö§â§Þ. 1 */

  I--;

L9: /* §°§Ò§â§Ñ§ä§ß§í§Û §á§à§Ú§ã§Ü 2 */

  if (SINT[J].ALT != 0)
  {
    J = SINT[J].ALT;
    goto L31;
  }

  J = SINT[J].PRED;

  if ((VXOD[idx_of_VXOD(SINT[J].DER, 3)].TYP == 'N')
    && (SINT[J].PRED > 0))
  {
    mcel(DST[L - 1].DST1, DST[L - 1].DST2, DST[L - 1].DST3);

  L10: /* §¢§Ý§à§Ü §á§Ö§â§Ö§Ò§à§â§Ñ §Ô§Ú§á§à§ä§Ö§Ù (§á§â§à§Õ§à§Ý§Ø§Ö§ß§Ú§Ö 1) */

    J = DST[L - 1].DST5;
    L--;
    goto L9;
  }

  if ((VXOD[idx_of_VXOD(SINT[J].DER, 3)].TYP == 'N')
    && (SINT[J].PRED == 0))
  {
    if (!strcmp(CEL[K - 1].CEL1, DST[L - 1].DST1))
      goto L6;
    else
      goto L10;
  }

  if (SINT[J].PRED > 0)
    goto L8;

  J = CEL[K - 1].CEL3;
  K--;

  if (J == 999)
  {
    fprintf(fp_out, " [ERROR] %s %s\n", VXOD[idx_of_VXOD(SINT[J].DER, 3)].SYM, "Undefined symbol!");
    fflush(fp_out);
    return 2;
  }
  else
    goto L8; // §¢§Ý§à§Ü §á§Ö§â§Ö§Ò§à§â§Ñ §Ô§Ú§á§à§ä§Ö§Ù §á§â§à§Õ§à§Ý§Ø§Ö§ß§Ú§Ö 2)
}

long int VALUE(char* s)                        /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
{                                                /* §á§Ö§â§Ö§Ó§à§Õ§Ñ §Õ§Ó§à§Ú§é§ß§à§Û      */
  long int S;                                     /* §Ü§à§ß§ã§ä§Ñ§ß§ä§í §Ú§Ù ASCIIz-§Ó§Ú-*/
  int i;                                          /* §Õ§Ñ §Ó§à §Ó§ß§å§ä§â§Ö§ß§ß§Ö§Ö §á§â§Ö§Õ§ã§ä§Ñ§Ó§Ý§Ö§ß§Ú§Ö §ä§Ú§á§Ñ long int */

  i = 0;
  S = 0;
  while (*(s + i) != 'B')

  {

    S <<= 1;
    if (*(s + i) == '1')
      S++;
    i++;
  }

  return (S);
}



/*..........................................................................*/
void FORM()                                      /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
{                                                /* §á§â§Ö§Õ§ã§ä§Ñ§Ó§Ý§Ö§ß§Ú§ñ §æ§â§Ñ§Ô§Þ§Ö§ß§ä§Ñ*/
             /* §á§Ý§à§ä§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ §Ó §Ó§Ú§Õ§Ö */
             /* §Þ§Ñ§ã§ã§Ú§Ó§Ñ 9-§ä§Ú §ã§Ú§Þ§Ó§à§Ý§î§ß§í§ç*/
             /* §Ý§Ö§Ü§ã§Ö§Þ                 */
  int i, j;

  for (IFORMT = 0; IFORMT < MAXFORMT; IFORMT++)
    memcpy(FORMT[IFORMT], "\x0\x0\x0\x0\x0\x0\x0\x0\x0", 9);

  IFORMT = 0;
  j = DST[I2].DST2;

FORM1:

  for (i = j; i <= DST[I2].DST4 + 1; i++)
  {
    if (STROKA[i] == ':' || STROKA[i] == ' ' ||
      STROKA[i] == '(' || STROKA[i] == ')' ||
      STROKA[i] == ';' || STROKA[i] == '+' ||
      STROKA[i] == '-' || STROKA[i] == '=' ||
      STROKA[i] == '*'
      )
    {
      FORMT[IFORMT][i - j] = '\x0';
      IFORMT++;
      j = i + 1;
      goto FORM1;
    }
    else
      FORMT[IFORMT][i - j] = STROKA[i];

  }

  return;
}



/*..........................................................................*/
              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
void ZKARD() /* §Ù§Ñ§á§Ú§ã§Ú §à§é§Ö§â§Ö§Õ§ß§à§Û §ã§Ô§Ö§ß§Ö-*/
{            /* §â§Ú§â§à§Ó§Ñ§ß§ß§à§Û §Ù§Ñ§á§Ú§ã§Ú §Ó§í-  */
             /* §ç§à§Õ§ß§à§Ô§à §æ§Ñ§Û§Ý§Ñ §Ó §Þ§Ñ§ã§ã§Ú§Ó */
             /* ASSTXT                 */

  char i;
  memcpy(ASSTXT[IASSTXT++], ASS_CARD.BUFCARD, 80);

  for (i = 0; i < 79; i++)
    ASS_CARD.BUFCARD[i] = ' ';
  return;
}


void ZKARD2(const char* label, const char* directive, /* Li  */
  const char* operand, const char* comment)
{
  char buffer[80];
  if (strlen(operand) > 0)
  {
    snprintf(buffer, sizeof(buffer), 
      "%s        %s    %s  %s", label, directive, operand, comment);
  }
  else
  {
    snprintf(buffer, sizeof(buffer), 
      " %s        %s     %s", label, directive, comment);
  }

  // §±§Ö§é§Ñ§ä§î §Õ§Ý§ñ §à§ä§Ý§Ñ§Õ§Ü§Ú, §Þ§à§Ø§ß§à §å§Ò§â§Ñ§ä§î §Ó §æ§Ú§ß§Ñ§Ý§î§ß§à§Û §Ó§Ö§â§ã§Ú§Ú
  //printf("Writing to ASSTXT[%d]: %s\n", IASSTXT, buffer);

  // §¬§à§á§Ú§â§à§Ó§Ñ§ß§Ú§Ö §ã§æ§à§â§Þ§Ú§â§à§Ó§Ñ§ß§ß§à§Û §ã§ä§â§à§Ü§Ú §Ó §Þ§Ñ§ã§ã§Ú§Ó ASSTXT §Ú §Ú§ß§Ü§â§Ö§Þ§Ö§ß§ä §Ú§ß§Õ§Ö§Ü§ã§Ñ
  memcpy(ASSTXT[IASSTXT++], buffer, strlen(buffer) + 1); // +1 §Õ§Ý§ñ §ä§Ö§â§Þ§Ú§ß§Ú§â§å§ð§ë§Ö§Ô§à §ß§å§Ý§ñ

  // §°§é§Ú§ã§ä§Ü§Ñ §Ò§å§æ§Ö§â§Ñ (§ß§Ö§à§Ò§ñ§Ù§Ñ§ä§Ö§Ý§î§ß§à, §Ù§Ñ§Ó§Ú§ã§Ú§ä §à§ä §ä§â§Ö§Ò§à§Ó§Ñ§ß§Ú§Û §Ü §Ò§Ö§Ù§à§á§Ñ§ã§ß§à§ã§ä§Ú)
  memset(buffer, 0, sizeof(buffer));
}


/* ///////////////////////////////////////////////////////////////// */


/*..........................................................................*/
              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ AVI §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* AVI -   "§Ñ§â§Ú§æ§Þ.§Ó§í§â§Ñ§Ø." */
int AVI1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ BUK §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* BUK -   "§Ò§å§Ü§Ó§Ñ"        */
int BUK1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ CIF §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* CIF -   "§è§Ú§æ§â§Ñ"        */
int CIF1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ IDE §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* IDE -   "§Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â"*/
int IDE1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ IPE §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* IPE - "§Ú§Þ§ñ §á§Ö§â§Ö§Þ§Ö§ß§ß§à§Û" */
int IPE1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ IPR §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* IPR -   "§Ú§Þ§ñ §á§â§à§Ô§â§Ñ§Þ§Þ§í" */
int IPR1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ LIT §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* LIT -   "§Ý§Ú§ä§Ö§â§Ñ§Ý"      */
int LIT1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ MAN §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* MAN -   "§Þ§Ñ§ß§ä§Ú§ã§ã§Ñ"     */
int MAN1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ ODC §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* ODC - "§à§á§Ö§â§Ñ§ä.§±§­1- DCL"*/
int ODC1()
{
  int i;
  FORM();                                   /* §æ§à§â§Þ§Ñ§ä§Ú§â§à§Ó§Ñ§ß§Ú§Ö §±§­1-§à§á§Ö§â§Ñ§ä§à§â§Ñ DCL*/

  for (i = 0; i < ISYM; i++)                    /* §Ö§ã§Ý§Ú §æ§Ú§Ü§ã§Ú§â§å§Ö§Þ §á§à§Ó§ä§à§â- */
  {                                              /* §á§à§Ó§ä§à§â§ß§à§Ö §à§Ò§ì§ñ§Ó§Ý§Ö§ß§Ú§Ö   */
    if (!strcmp(SYM[i].NAME, FORMT[1]) &&  /* §Ó§ä§à§â§à§Ô§à §ä§Ö§â§Þ§Ñ §à§á§Ö§â§Ñ§ä§à§â§Ñ*/
      strlen(SYM[i].NAME) ==              /* DCL, §ä§à                */
      strlen(FORMT[1])
      )
      return 6;                                    /* §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §á§â§à§Ô§â§Ñ§Þ§Þ§í   */
    /* §á§à §à§ê§Ú§Ò§Ü§Ö              */
  }

  strcpy(SYM[ISYM].NAME, FORMT[1]);          /* §á§â§Ú §à§ä§ã§å§ä§ã§ä§Ó§Ú§Ú §á§à§Ó§ä§à§â- */
  strcpy(SYM[ISYM].RAZR, FORMT[4]);          /* §ß§à§Ô§à §à§Ò§ì§ñ§Ó§Ý§Ö§ß§Ú§ñ §Ú§Õ§Ö§ß§ä§Ú-*/
  /* §æ§Ú§Ü§Ñ§ä§à§â§Ñ §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§Ö§Þ §Ö§Ô§à*/
  /* §Ó§Þ§Ö§ã§ä§Ö §ã §â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§î§ð §Ó*/
  /* §ä§Ñ§Ò§Ý.SYM               */

  /* §Ö§ã§Ý§Ú §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â §à§á§â§Ö§Õ§Ö§Ý§Ö§ß §Ü§Ñ§Ü bin fixed, */
  if (!strcmp(FORMT[2], "BIN") && !strcmp(FORMT[3], "FIXED"))
  {
    SYM[ISYM].TYPE = 'B';                        /* §ä§à §å§ã§ä§Ñ§ß§Ñ§Ó§Ý§Ú§Ó§Ñ§Ö§Þ §ä§Ú§á   */
    /* §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§Ñ = 'B' §Ú */
    goto ODC11;                                   /* §Ú§Õ§Ö§Þ §ß§Ñ §á§â§à§Õ§à§Ý§Ø§Ö§ß§Ú§Ö §à§Ò-*/
    /* §â§Ñ§Ò§à§ä§Ü§Ú, §Ñ             */
  }
  /* DCL A DEC FIXED INIT (5); */
  else if (!strcmp(FORMT[2], "DEC") && !strcmp(FORMT[3], "FIXED")) // Li
  {
    SYM[ISYM].TYPE = 'D';
    if (!strcmp(FORMT[4], "INIT")) // Li
    {
      strcpy(SYM[ISYM++].INIT, FORMT[5]);
    }
  }
  /* DCL B BIT(16); */
  else if (!strcmp(FORMT[2], "BIT"))
  {
    SYM[ISYM].TYPE = 'b';
  }
  else                                            /* §Ú§ß§Ñ§é§Ö                  */
  {
    SYM[ISYM].TYPE = 'U';                        /* §å§ã§ä§Ñ§ß§Ñ§Ó§Ý§Ú§Ó§Ñ§Ö§Þ §ä§Ú§á §Ú§Õ§Ö§ß-*/
    /* §ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§Ñ = 'U'  §Ú    */
    fprintf(fp_out, "--->[Error]UNDIFINED SYMBOL: %s %s %s\n", FORMT[1], FORMT[2], FORMT[3]); // Li
    fflush(fp_out);
    return 2;                                     /* §Ù§Ñ§Ó§Ö§â§ê§Ñ§Ö§Þ §á§â§à§Ô§â§Ñ§Þ§Þ§å    */
    /* §á§à §à§ê§Ú§Ò§Ü§Ö              */
  }

ODC11:                                            /* §Ö§ã§Ý§Ú §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â     */
  /* §Ú§Þ§Ö§Ö§ä §ß§Ñ§é§Ñ§Ý§î§ß§å§ð §Ú§ß§Ú§è§Ú- */
  if (!strcmp(FORMT[5], "INIT"))           /* §Ñ§Ý§Ú§Ù§Ñ§è§Ú§ð, §ä§à §Ù§Ñ§á§à§Þ§Ú§ß§Ñ- */
    strcpy(SYM[ISYM++].INIT, FORMT[6]);       /* §Ö§Þ §Ó §ä§Ñ§Ò§Ý. SYM §ï§ä§à §ß§Ñ- */
  /* §é§Ñ§Ý§î§ß§à§Ö §Ù§ß§Ñ§é§Ö§ß§Ú§Ö, §Ñ    */
  else                                            /* §Ú§ß§Ñ§é§Ö                  */
    strcpy(SYM[ISYM++].INIT, "0B");            /* §Ú§ß§Ú§è§Ú§Ñ§Ý§Ú§Ù§Ú§â§å§Ö§Þ §Ú§Õ§Ö§ß§ä§Ú- */
  /* §æ§Ú§Ü§Ñ§ä§à§â §ß§å§Ý§Ö§Þ          */

  return 0;                                      /* §å§ã§á§Ö§ê§ß§à§Ö §Ù§Ñ§Ó§Ö§ê§Ö§ß§Ú§Ö     */
  /* §á§â§à§Ô§â§Ñ§Þ§Þ§í              */
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ OEN §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* OEN - "§à§á§Ö§â§Ñ§ä.§±§­1-END" */
int OEN1()
{
  char i = 0;
  FORM();                                        /* §æ§à§â§Þ§Ñ§ä§Ú§â§à§Ó§Ñ§ß§Ú§Ö §±§­1-§à§á§Ö-*/
  /* §â§Ñ§ä§à§â§Ñ END             */

  for (i = 0; i < ISYM; i++)                    /* §Ö§ã§Ý§Ú §Ó§ä§à§â§Û §ä§Ö§â§Þ §à§á§Ö§â§Ñ- */
    /* §ä§à§â§Ñ END §Ù§Ñ§á§Ú§ã§Ñ§ß §Ó §ä§Ñ§Ò§Ý*/
  {                                              /* SYM §Ú §Ö§Ô§à §ä§Ú§á = "P",§ä§à:*/
    if (!strcmp(SYM[i].NAME, FORMT[1]) &&
      (SYM[i].TYPE == 'P') &&
      strlen(SYM[i].NAME) ==
      strlen(FORMT[1]))
      return 0;                                    /* §å§ã§á§Ö§ê§ß§à§Ö §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö    */
    /* §á§â§à§Ô§â§Ñ§Þ§Þ§í              */
  }

  return 1;                                       /* §Ú§ß§Ñ§é§Ö §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §á§â§à§Ô- */
  /* §â§Ñ§Þ§Þ§í §á§à §à§ê§Ú§Ò§Ü§Ö        */
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ OPA §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* OPA - "§à§á§Ö§â§Ñ§ä.§á§â§Ú§ã§Ó§Ñ§Ú- */
              /* §Ó§Ñ§ß§Ú§ñ §Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é§Ö§ã§Ü§Ú§Û   */
int OPA1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ OPR §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* OPR - "§à§á§Ö§â§Ñ§ä.§±§­1-PROC"*/
int OPR1()
{
  FORM();                                        /* §æ§à§â§Þ§Ñ§ä§Ú§â§å§Ö§Þ §à§á§Ö§â§Ñ§ä§à§â   */
  /* §±§­1 PROC               */

  strcpy(SYM[ISYM].NAME, FORMT[0]);          /* §á§Ö§â§Ö§á§Ú§ê§Ö§Þ §Ú§Þ§ñ §±§­1-§á§â§à§Ô-*/
  /* §â§Ñ§Þ§Þ§í §Ó §ä§Ñ§Ò§Ý. SYM,     */

  SYM[ISYM].TYPE = 'P';                        /* §å§ã§ä§Ñ§ß§à§Ó§Ú§Þ §ä§Ú§á §ï§ä§à§Ô§à    */
  /* §Ú§Þ§Ö§ß§Ú = 'P'            */
  SYM[ISYM++].RAZR[0] = '\x0';                  /* §å§ã§ä§Ñ§ß§à§Ó§Ú§Þ §â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§î  */
  /* §â§Ñ§Ó§ß§à§Û 0               */

  return 0;                                       /* §å§ã§á§Ö§ê§ß§à§Ö §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö    */
  /* §á§â§à§Ô§â§Ñ§Þ§Þ§í              */
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ PRO §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* PRO - "§á§â§à§Ô§â§Ñ§Þ§Þ§Ñ"      */

int PRO1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ RZR §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* RZR - "§â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§î"    */

int RZR1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ TEL §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* TEL - "§ä§Ö§Ý§à §á§â§à§Ô§â§Ñ§Þ§Þ§í" */

int TEL1()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ ZNK §ß§Ñ §á§Ö§â-*/
              /* §Ó§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* ZNK - "§Ù§ß§Ñ§Ü §à§á§Ö§â§Ñ§è§Ú§Ú"  */

int ZNK1()
{
  return 0;
}


int DCF1() // Li
{
  return 0;
}

int DCF2()
{
  //char RAB[20];
  //FORM();
  //for (int i = 0; i < ISYM; i++) 
  //{
  //  if (isalpha(SYM[i].NAME[0]))
  //  {
  //    if (SYM[i].TYPE == 'D')
  //    {
  //      char op[20] = "PL6\'";  
  //      strcat(op, SYM[i].INIT);
  //      strcat(op, "\'");       

  //      // §£§í§Ù§à§Ó §ß§à§Ó§à§Û §æ§å§ß§Ü§è§Ú§Ú ZKARD2 §Õ§Ý§ñ §Ù§Ñ§á§Ú§ã§Ú §Ó ASSTXT
  //      ZKARD2(SYM[i].NAME, "DC", op, "Initialization decimal");
  //    }
  //  }
  //}
  return 0;
}


/* ///////////////////////////////////////////////////////////////// */

int AVI2() /* AVI -   "§Ñ§â§Ú§æ§Þ.§Ó§í§â§Ñ§Ø." */
{
  char i;
  FORM();                                        /*§æ§à§â§Þ§Ñ§ä§Ú§â§å§Ö§Þ §á§â§Ñ§Ó§å§ð §é§Ñ§ã§ä§î*/
  /*§Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é§Ö§ã§Ü§à§Ô§à §±§­1-§à§á§Ö-*/
  /*§â§Ñ§ä§à§â§Ñ §á§â§Ú§ã§Ó§Ñ§Ú§Ó§Ñ§ß§Ú§ñ     */

  if (IFORMT == 1)                              /* §Ö§ã§Ý§Ú §á§â§Ñ§Ó§Ñ§ñ §é§Ñ§ã§ä§î §à§Õ§ß§à-*/
  {                                            /* §ä§Ö§â§Þ§à§Ó§Ñ§ñ, §ä§à:          */
    for (i = 0; i < ISYM; i++)                  /* §Ú§ë§Ö§Þ §ï§ä§à§ä §ä§Ö§â§Þ §Ó §ä§Ñ§Ò§Ý§Ú-*/
    {                                            /* §è§Ö §Ú§Þ§Ö§ß  §Ú             */
      if (!strcmp(SYM[i].NAME, FORMT[0]) &&/* §Ö§ã§Ý§Ú §ß§Ñ§ç§à§Õ§Ú§Þ, §ä§à:      */
        strlen(SYM[i].NAME) == strlen(FORMT[0]))
      {
        if (SYM[i].TYPE == 'B')              /* §Ó §ã§Ý§å§é§Ñ§Ö §ä§Ú§á§Ñ=bin fixed*/
        {

          if (strcmp(SYM[i].RAZR, "15")    /* §Ú §â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§Ú <= 15    */
            <= 0)
            memcpy(ASS_CARD._BUFCARD.OPERAC,   /* §æ§à§â§Þ§Ú§â§å§Ö§Þ §Ü§à§Õ §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö-*/
              "LH", 2);/* §â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú LH,   */
          else
            memcpy(ASS_CARD._BUFCARD.OPERAC,   /* §Ñ §á§â§Ú §â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§Ú >15  */
              "L", 1);/* §æ§à§â§Þ§Ú§â§å§Ö§Þ §Ü§à§Õ §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö-*/
          /* §â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú L     */

          strcpy(ASS_CARD._BUFCARD.OPERAND,   /*       §æ§à§â§Þ§Ú§â§å§Ö§Þ        */
            "RRAB,");/*       §á§Ö§â§Ó§í§Û  §Ú        */
          strcat(ASS_CARD._BUFCARD.OPERAND,   /* §Ó§ä§à§â§à§Û §à§á§Ö§â§Ñ§ß§Õ§í §Ñ§ã§ã§Ö§Þ§Ò-*/
            FORMT[0]);/* §Ý§Ö§â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú     */

          ASS_CARD._BUFCARD.OPERAND[strlen    /* §Ó§ã§ä§Ñ§Ó§Ý§ñ§Ö§Þ §â§Ñ§Ù§Õ§Ö§Ý§Ú§ä§Ö§Ý§î  */
          (ASS_CARD._BUFCARD.OPERAND)] = ' ';

          memcpy(ASS_CARD._BUFCARD.COMM,      /* §Ú §á§à§ã§ä§â§à§é§ß§í§Û §Ü§à§Þ§Ö§ß§ä§Ñ§â§Ú§Û*/
            "Load var into register", 29);

          ZKARD();                             /* §Ù§Ñ§á§à§Þ§ß§Ú§ä§î §à§á§Ö§â§Ñ§è§Ú§ð §Ñ§ã- */
          /* §ã§Ö§Þ§Ò§Ý§Ö§â§Ñ  §Ú            */
          return 0;                             /* §Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §á§â§à§Ô§â§Ñ§Þ§Þ§å    */
        }
        else if (SYM[i].TYPE == 'D') {  // Li: TODO MVC?
          ZKARD2("", " MVC", "@BUF+2(6)", "Move from cache A to @BUF");
          return 0;
        }
        else
        {
          return 3;                              /* §Ö§ã§Ý§Ú §ä§Ú§á §ä§Ö§â§Þ§Ñ §ß§Ö bin  */
          /* fixed,§ä§à §Ó§í§ç§à§Õ §á§à §à§ê§Ú§Ò§Ü§Ö*/
        }

      }
    }
    return 4;                                     /* §Ö§ã§Ý§Ú §ä§Ö§â§Þ-§Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â*/
    /* §ß§Ö§à§á§â§Ö§Õ§Ö§Ý§Ö§ß, §ä§à §Ó§í§ç§à§Õ  */
    /* §á§à §à§ê§Ú§Ò§Ü§Ö              */
  }
  else                                            /* §Ö§ã§Ý§Ú §á§â§Ñ§Ó§Ñ§ñ §é§Ñ§ã§ä§î §Ñ§â§Ú§æ-*/
              /* §Þ§Ö§ä§Ú§é§Ö§ã§Ü§à§Ô§à §Ó§í§â§Ñ§Ø§Ö§ß§Ú§ñ  */
              /* §Õ§Ó§å§ç§ä§Ö§â§Þ§à§Ó§Ñ§ñ, §ä§à:      */
  {
    for (i = 0; i < ISYM; i++)                  /* §Ö§ã§Ý§Ú §á§â§Ñ§Ó§í§Û §ä§Ö§â§Þ §Ñ§â§Ú§æ- */
    {                                            /* §Þ§Ö§ä§Ú§é§Ö§ã§Ü§à§Ô§à §Ó§í§â§Ñ§Ø§Ö§ß§Ú§ñ  */
      if (!strcmp(SYM[i].NAME,                /*§à§á§â§Ö§Õ§Ö§Ý§Ö§ß §Ó §ä§Ñ§Ò§Ý.SYM,§ä§à:*/
        FORMT[IFORMT - 1]) &&
        strlen(SYM[i].NAME) ==
        strlen(FORMT[IFORMT - 1])
        )
      {
        if (SYM[i].TYPE == 'B')              /* §Ö§ã§Ý§Ú §ä§Ú§á §á§â§Ñ§Ó§à§Ô§à §à§á§Ö-  */
        {                                      /* §â§Ñ§ß§Õ§Ñ bin fixed, §ä§à:   */

          if (STROKA[DST[I2].DST4 -         /* §Ö§ã§Ý§Ú §Ù§ß§Ñ§Ü §à§á§Ö§â."+",§ä§à: */
            strlen(FORMT[IFORMT - 1])] == '+')
          {
            if (strcmp(SYM[i].RAZR, "15")  /* §Ö§ã§Ý§Ú §â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§î §á§â§Ñ§Ó. */
              <= 0)/* §à§á§Ö§â§Ñ§ß§Õ§Ñ <= 15, §ä§à:    */
              memcpy(ASS_CARD._BUFCARD.OPERAC,
                "AH", 2);/* §æ§à§â§Þ§Ú§â§å§Ö§Þ §Ü§à§Õ §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö-*/
            else                                /* §â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú "AH",§Ñ*/
              memcpy(ASS_CARD._BUFCARD.OPERAC,
                "A", 1);/* §Ú§ß§Ñ§é§Ö - "A"            */
          }

          else

          {
            if (STROKA[DST[I2].DST4 -       /* §Ö§ã§Ý§Ú §Ø§Ö §Ù§ß§Ñ§Ü §à§á§Ö§â§Ñ§è§Ú§Ú  */
              strlen(FORMT[IFORMT - 1])] == /* §Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é§Ö§ã§Ü§à§Ô§à §Ó§í§â§Ñ-  */
              '-')/* §Ø§Ö§ß§Ú§ñ "-", §ä§à:         */

            {
              if (strcmp(SYM[i].RAZR, "15")/* §á§â§Ú §â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§Ú §Ñ§â§Ú§æ-  */
                <= 0)/* §Þ§Ö§ä§Ú§é.§Ó§í§â§Ñ§Ø.<= 15      */
                memcpy(ASS_CARD._BUFCARD.OPERAC,/* §æ§à§â§Þ§Ú§â§å§Ö§Þ §Ü§à§Õ §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö-*/
                  "SH", 2);/* §â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú "SH",F*/
              else
                memcpy(ASS_CARD._BUFCARD.OPERAC,/* §Ú§ß§Ñ§é§Ö - "S"            */
                  "S", 1);
            }

            else

              return 5;                          /* §Ö§ã§Ý§Ú §Ù§ß§Ñ§Ü §à§á§Ö§â§Ñ§è§Ú§Ú §ß§Ö  */
            /* "+" §Ú §ß§Ö "-", §ä§à §Ù§Ñ§Ó§Ö§â-*/
            /* §ê§Ö§ß§Ú§Ö  §á§â§à§Ô§â§Ñ§Þ§Þ§í  §á§à   */
            /* §à§ê§Ú§Ò§Ü§Ö                 */
          }
          /* §æ§à§â§Þ§Ú§â§å§Ö§Þ:             */
          strcpy(ASS_CARD._BUFCARD.OPERAND,   /* - §á§Ö§â§Ó§í§Û §à§á§Ö§â§Ñ§ß§Õ §Ñ§ã§ã§Ö§Þ-*/
            "RRAB,");/*§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú;    */
          strcat(ASS_CARD._BUFCARD.OPERAND,   /* - §Ó§ä§à§â§à§Û §à§á§Ö§â§Ñ§ß§Õ §Ñ§ã§ã§Ö§Þ-*/
            FORMT[IFORMT - 1]);/*§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú;    */
          ASS_CARD._BUFCARD.OPERAND[strlen
          (ASS_CARD._BUFCARD.OPERAND)] =/* - §â§Ñ§Ù§Õ§Ö§Ý§ñ§ð§ë§Ú§Û §á§â§à§Ò§Ö§Ý;  */
            ' ';
          memcpy(ASS_CARD._BUFCARD.COMM,
            "Formation of intermediate value",/* - §á§à§ã§ä§â§à§é§ß§í§Û §Ü§à§Þ§Ö§ß§ä§Ñ§â§Ú§Û*/
            36);
          ZKARD();                             /* §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§ß§Ú§Ö §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö-  */
          /* §â§à§Ó§ã§Ü§à§Û §à§á§Ö§â§Ñ§è§Ú§Ú       */

          return 0;                             /* §å§ã§á§Ö§ê§ß§à§Ö §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö    */
          /* §á§à§Ô§â§Ñ§Þ§Þ§í               */
        }
        else
          return 3;                              /* §Ö§ã§Ý§Ú §ä§Ú§á §á§â§Ñ§Ó§à§Ô§à §à§á§Ö-  */
        /* §â§Ñ§ß§Õ§Ñ §Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é§Ö§ã§Ü§à§Ô§à  */
        /* §Ó§í§â§Ñ§Ø§Ö§ß§Ú§ñ §ß§Ö bin fixed,*/
        /* §ä§à §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §á§â§à§Ô§â§Ñ§Þ- */
        /* §Þ§í §á§à §à§ê§Ú§Ò§Ü§Ö           */
      }
    }
    return 4;                                     /* §Ö§ã§Ý§Ú §á§â§Ñ§Ó§í§Û §à§á§Ö§â§Ñ§ß§Õ    */
    /* §Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é§Ö§ã§Ü§à§Ô§à §Ó§í§â§Ñ§Ø§Ö-*/
    /*§ß§Ú§ñ §ß§Ö §à§á§â§Ö§Õ§Ö§Ý§Ö§ß §Ó §ä§Ñ§Ò§Ý.*/
    /* SYM, §ä§à §Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §á§â§à- */
    /* §Ô§â§Ñ§Þ§Þ§å §á§à §à§ê§Ú§Ò§Ü§Ö       */
  }

}

/*..........................................................................*/

int BUK2() /* BUK -   "§Ò§å§Ü§Ó§Ñ"        */
{
  return 0;
}

/*..........................................................................*/

int CIF2() /* CIF -   "§è§Ú§æ§â§Ñ"        */
{
  return 0;
}

/*..........................................................................*/

int IDE2() /* IDE -   "§Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â"*/
{
  return 0;
}


/*..........................................................................*/

int IPE2()   /* IPE - "§Ú§Þ§ñ §á§Ö§â§Ö§Þ§Ö§ß§ß§à§Û" */
{
  return 0;
}

/*..........................................................................*/

int IPR2()              /* IPR -   "§Ú§Þ§ñ §á§â§à§Ô§â§Ñ§Þ§Þ§í" */
{
  return 0;
}

/*..........................................................................*/

int LIT2()              /* LIT -   "§Ý§Ú§ä§Ö§â§Ñ§Ý"      */
{
  return 0;
}

/*..........................................................................*/

int MAN2() /* MAN -   "§Þ§Ñ§ß§ä§Ú§ã§ã§Ñ"     */
{
  return 0;
}

/*..........................................................................*/

int ODC2() /* ODC - "§à§á§Ö§â§Ñ§ä.§±§­1- DCL"*/
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ OEN §ß§Ñ §Ó§ä§à-*/
              /* §â§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* OEN - "§à§á§Ö§â§Ñ§ä.§±§­1-END" */

              /* §á§â§à§Ô§â§Ñ§Þ§Þ§Ñ    §æ§à§â§Þ§Ú§â§å§Ö§ä */
              /* §ï§á§Ú§Ý§à§Ô §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Ô§à*/
              /* §ï§Ü§Ó§Ú§Ó§Ñ§Ý§Ö§ß§ä§Ñ §±§­1-§á§â§à§Ô-  */
              /* §â§Ñ§Þ§Þ§í                  */
int OEN2()
{
  char RAB[20];
  char i = 0;
  FORM();                                        /* §æ§à§â§Þ§Ñ§ä§Ú§â§å§Ö§Þ §±§­1-§à§á§Ö§â§Ñ- */
  /* §ä§à§â END                */

  memcpy(ASS_CARD._BUFCARD.OPERAC, "BCR", 3);  /* §æ§à§â§Þ§Ú§â§å§Ö§Þ §Ü§à§Õ §Ò§Ö§Ù§å§ã§Ý§à§Ó-*/
  /*§ß§à§Ô§à §Ó§à§Ù§Ó§â§Ñ§ä§Ñ §å§á§â§Ñ§Ó§Ý§Ö§ß§Ú§ñ*/
  /* §Ó §Ó§í§Ù§í§Ó§Ñ§ð§ë§å§ð §á§â§à§Ô§â§Ñ§Þ§Þ§å */
  memcpy(ASS_CARD._BUFCARD.OPERAND, "15,@RVIX", 8);/* §à§á§Ö§â§Ñ§ß§Õ§í §Ü§à§Þ§Ñ§ß§Õ§í §Ú     */
  memcpy(ASS_CARD._BUFCARD.COMM,                /* §á§à§Ý§Ö §á§à§ã§ä§â§à§é§ß§à§Ô§à §Ü§à§Þ§Ö§ß-*/
    "Exit from program", 18);/* §ä§Ñ§â§Ú§ñ                  */

  ZKARD();                                       /* §Ù§Ñ§á§à§Þ§ß§Ú§ä§î §à§á§â§Ö§Ñ§è§Ú§ð §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ */

  /* §Õ§Ñ§Ý§Ö§Ö §Ú§Õ§Ö§ä §Ò§Ý§à§Ü §æ§à§â§Þ§Ú- */
  /* §â§à§Ó§Ñ§ß§Ú§ñ §Õ§Ö§Ü§Ý§Ñ§â§Ñ§ä§Ú§Ó§ß§í§ç  */
  /* §á§ã§Ö§Ó§Õ§à§à§á§Ö§â§Ñ§è§Ú§Û DC §Õ§Ý§ñ  */
  /* §Ü§Ñ§Ø§Õ§à§Ô§à §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â§Ñ,*/
  /* §á§à§á§Ñ§Ó§ê§Ö§Ô§à §Ó §ä§Ñ§Ò§Ý.SYM   */
  for (i = 0; i < ISYM; i++)
  {
    if (isalpha(SYM[i].NAME[0])) /* §Ö§ã§Ý§Ú §ã§ä§â§à§Ü§Ñ §ä§Ñ§Ò§Ý.SYM §ã§à§Õ§Ö§â§Ø§Ú§ä §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â, */
      /* §ä.§Ö.§ß§Ñ§é§Ú§ß§Ñ§Ö§ä§ã§ñ §ã §Ò§å§Ü§Ó§í,*/
    {                                            /* §ä§à:                    */
      if (SYM[i].TYPE == 'B')      /* §Ö§ã§Ý§Ú §ä§Ú§á §à§á§Ö§â§Ñ§ä§à§â§Ñ BIN FIXED, §ä§à:*/
      {
        strcpy(ASS_CARD._BUFCARD.METKA,         /* §á§Ú§ê§Ö§Þ §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â §Ó  */
          SYM[i].NAME); /* §á§à§Ý§Ö §Þ§Ö§ä§Ü§Ú §á§ã§Ö§Ó§Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú DC*/
        ASS_CARD._BUFCARD.METKA[strlen(ASS_CARD._BUFCARD.METKA)] = ' '; /* §á§Ú§ê§Ö§Þ §â§Ñ§Ù§Õ§Ö§Ý§Ú§ä§Ö§Ý§î §á§à§Ý§Ö§Û*/

        // TODO, ¿¼ÂÇDSµÄÇé¿ö
        memcpy(ASS_CARD._BUFCARD.OPERAC, "DC", 2);       /* §á§Ú§ê§Ö§Þ §Ü§à§Õ §á§ã§Ö§Ó§Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú DC */

        if (strcmp(SYM[i].RAZR, "15") <= 0) /* §æ§à§â§Þ§Ú§â§å§Ö§Þ §à§á§Ö§â§Ñ§ß§Õ§í §á§ã§Ö§Ó§Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú DC */
          strcpy(ASS_CARD._BUFCARD.OPERAND, "H\'");     /* §Õ§Ý§ñ §ã§Ý§å§é§Ñ§ñ §á§à§Ý§å§ã§Ý§à§Ó§Ñ   */

        else                                      /* §Ú§Ý§Ú §Õ§Ý§ñ §ã§Ý§å§é§Ñ§ñ §ã§Ý§à§Ó§Ñ */
          strcpy(ASS_CARD._BUFCARD.OPERAND, "F\'");

        //Dos command
        //	strcat ( ASS_CARD._BUFCARD.OPERAND,       /* §æ§à§â§Þ§Ú§â§å§Ö§Þ §è§Ú§æ§â§à§Ó§å§ð     */
        //		 ltoa ( VALUE (SYM [i].INIT),     /* §é§Ñ§ã§ä§î §à§á§Ö§â§Ñ§ß§Õ§Ñ §á§ã§Ö§Ó§Õ§à- */
        //				 &RAB [0], 10) ); /* §à§á§Ö§â§Ñ§è§Ú§Ú,              */
        //let's do that in Unix!
        strcat(ASS_CARD._BUFCARD.OPERAND, gcvt(VALUE(SYM[i].INIT), 10, &RAB[0]));
        ASS_CARD._BUFCARD.OPERAND[strlen        /* §Ù§Ñ§Þ§í§Ü§Ñ§ð§ë§Ú§Û §Ñ§á§à§ã§ä§â§à§æ    */
        (ASS_CARD._BUFCARD.OPERAND)] = '\'';  /*          §Ú             */

        memcpy(ASS_CARD._BUFCARD.COMM,          /* §á§à§Ý§Ö §á§à§ã§ä§â§à§é§ß§à§Ô§à §Ü§à§Þ§Ö§ß-*/
          "Defination of var", 22);  /* §ä§Ñ§â§Ú§ñ                  */

        ZKARD();                                 /* §Ù§Ñ§á§à§Þ§ß§Ú§ä§î §à§á§Ö§â§Ñ§è§Ú§ð     */
        /*    §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ          */
      }
      else if (SYM[i].TYPE == 'b') /* Li: DCL <IDE> BIT(<RZR>)*/
      {
        ZKARD2(SYM[i].NAME, "DS", "0F", "Initialization BIT."); // TODO Ôö¼ÓÒ»Ð©ÅÐ¶Ï£¬²»ÒªÓ²±àÂëÐ´0F
      }
      else if (SYM[i].TYPE == 'D')
      {
        char RAB[20];
        FORM();
        char op[20] = "PL6\'";
        strcat(op, SYM[i].INIT);
        strcat(op, "\'");

        // §£§í§Ù§à§Ó §ß§à§Ó§à§Û §æ§å§ß§Ü§è§Ú§Ú ZKARD2 §Õ§Ý§ñ §Ù§Ñ§á§Ú§ã§Ú §Ó ASSTXT
        ZKARD2(SYM[i].NAME, "DC", op, "Initialization DECIMAL.");
      }
    }
  }

  if (is_cvb) { // Li: if the CVB command is used
    ZKARD2("", " DS", "0F", "Memory allocation for CVB.");
    ZKARD2("@BUF", "DC", "PL8\'0\'", "Buffer for CVB.");
  }

  /* §Õ§Ñ§Ý§Ö§Ö §Ú§Õ§Ö§ä §Ò§Ý§à§Ü §Õ§Ö§Ü§Ý§Ñ- */
  /* §â§Ñ§ä§Ú§Ó§ß§í§ç §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö§â§à§Ó§ã- */
  /* §Ü§Ú§ç EQU-§à§á§Ö§â§Ñ§ä§à§â§à§Ó, §à§á-*/
  /* §â§Ö§Õ§Ö§Ý§ñ§ð§ë§Ú§ç §Ò§Ñ§Ù§à§Ó§í§Û §Ú   */
  /* §â§Ñ§Ò§à§é§Ú§Û §â§Ö§Ô§Ú§ã§ä§â§í §à§Ò§ë§Ö§Ô§à*/
  /* §ß§Ñ§Ù§ß§Ñ§é§Ö§ß§Ú§ñ             */

  memcpy(ASS_CARD._BUFCARD.METKA, "@RVIX", 5);  /* Li */
  memcpy(ASS_CARD._BUFCARD.OPERAC, "EQU", 3);
  memcpy(ASS_CARD._BUFCARD.OPERAND, "14", 2);
  ZKARD();

  memcpy(ASS_CARD._BUFCARD.METKA, "@RBASE", 6); /* §æ§à§â§Þ§Ú§â§à§Ó§Ñ§ß§Ú§Ö EQU-§á§ã§Ö§Ó- */
  memcpy(ASS_CARD._BUFCARD.OPERAC, "EQU", 3);   /* §Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú §à§á§â§Ö§Õ§Ö§Ý§Ö§ß§Ú§ñ */ /* ÕâÀïËÆºõ±»Ö´ÐÐÁËÁ½´Î£¿*/
  memcpy(ASS_CARD._BUFCARD.OPERAND, "15", 2);  /* §ß§à§Þ§Ö§â§Ñ §Ò§Ñ§Ù§à§Ó§à§Ô§à §â§Ö§Ô§Ú§ã§ä§â§Ñ §à§Ò§ë§Ö§Ô§à §ß§Ñ§Ù§ß§Ñ§é§Ö§ß§Ú§ñ*/
  /*           §Ú            */
  ZKARD();                                       /* §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§ß§Ú§Ö §Ö§Ö         */

  memcpy(ASS_CARD._BUFCARD.METKA, "@RRAB", 5);  /* §æ§à§â§Þ§Ú§â§à§Ó§Ñ§ß§Ú§Ö EQU-§á§ã§Ö§Ó- */
  memcpy(ASS_CARD._BUFCARD.OPERAC, "EQU", 3);   /* §Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú §à§á§â§Ö§Õ§Ö§Ý§Ö§ß§Ú§ñ */
  memcpy(ASS_CARD._BUFCARD.OPERAND, "5", 1);   /* §ß§à§Þ§Ö§â§Ñ §Ò§Ñ§Ù§à§Ó§à§Ô§à §â§Ö§Ô§Ú§ã§ä-*/
  /* §â§Ñ §à§Ò§ë§Ö§Ô§à §ß§Ñ§Ù§ß§Ñ§é§Ö§ß§Ú§ñ   */
  /*            §Ú           */
  ZKARD();                                       /* §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§ß§Ú§Ö §Ö§Ö         */

  memcpy(ASS_CARD._BUFCARD.OPERAC, "END", 3);  /* §æ§à§â§Þ§Ú§â§à§Ó§Ñ§ß§Ú§Ö §Ü§à§Õ§Ñ §Ñ§ã-  */
  /* §ã§Ö§Þ§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Û §á§ã§Ö§Ó§Õ§à-  */
  /* §à§á§Ö§â§Ñ§è§Ú§Ú END,          */
  i = 0;

  while (FORMT[1][i] != '\x0')                 /* §Ö§Ö §à§á§Ö§â§Ñ§ß§Õ§Ñ            */
    ASS_CARD._BUFCARD.OPERAND[i] = FORMT[1][i++];/*         §Ú              */

  memcpy(ASS_CARD._BUFCARD.COMM,                /* §á§à§ã§ä§â§à§é§ß§à§Ô§à §Ü§à§Þ§Ö§ß§ä§Ñ§â§Ú§ñ */
    "End of program", 15);

  ZKARD();                                       /* §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§ß§Ú§Ö §á§ã§Ö§Ó§Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú*/
  return 0;                                       /* §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §á§â§à§Ô§â§Ñ§Þ§Þ§í   */
}


/*..........................................................................*/

int OPA2() /* OPA - "§à§á§Ö§â§Ñ§ä.§á§â§Ú§ã§Ó§Ñ§Ú§Ó§Ñ§ß§Ú§ñ §Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é§Ö§ã§Ü§Ú§Û */
{
  int i;

  FORM();                                        /*§æ§à§â§Þ§Ñ§ä§Ú§â§å§Ö§Þ §±§­1-§à§á§Ö§â§Ñ§ä§à§â*/
  /*§á§â§Ú§ã§Ó§Ñ§Ú§Ó§Ñ§ß§Ú§ñ §Ñ§â§Ú§æ§Þ§Ö§ä§Ú§é. */

  for (i = 0; i < ISYM; i++)
  {                                              /* §Ö§ã§Ý§Ú §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â §á§â§Ñ-*/
             /* §Ó§à§Û §é§Ñ§ã§ä§Ú §à§á§Ö§â§Ñ§ä§à§â§Ñ §à§á-*/
    if (!strcmp(SYM[i].NAME, FORMT[0]) &&  /* §â§Ö§Õ§Ö§Ý§Ö§ß §â§Ñ§ß§Ö§Ö §é§Ö§â§Ö§Ù    */
      strlen(SYM[i].NAME) ==               /* §à§á§Ö§â§Ñ§ä§à§â DCL, §ä§à:      */
      strlen(FORMT[0])
      )
    {
      if (SYM[i].TYPE == 'B')              /* §Ö§ã§Ý§Ú §ï§ä§à§ä §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â*/
      {                                      /* §Ú§Þ§Ö§Ö§ä §ä§Ú§á bin fixed,§ä§à:*/

        if (strcmp(SYM[i].RAZR, "15")    /* §Ö§ã§Ý§Ú bin fixed (15),§ä§à:*/
          <= 0)
          memcpy(ASS_CARD._BUFCARD.OPERAC,   /* §ã§æ§à§â§Þ§Ú§â§à§Ó§Ñ§ä§î §Ü§à§Þ§Ñ§ß§Õ§å   */
            "STH", 3);/* §Ù§Ñ§á§Ú§ã§Ú §á§à§Ý§å§ã§Ý§à§Ó§Ñ       */

        else                                  /* §Ú§ß§Ñ§é§Ö:                 */
          memcpy(ASS_CARD._BUFCARD.OPERAC,   /* §Ü§à§Þ§Ñ§ß§Õ§å §Ù§Ñ§á§Ú§ã§Ú §ã§Ý§à§Ó§Ñ   */
            "ST", 2);

        strcpy(ASS_CARD._BUFCARD.OPERAND,   /*       §Õ§à§æ§à§â§Þ§Ú§â§à§Ó§Ñ§ä§î    */
          "RRAB,");/*          §à§á§Ö§â§Ñ§ß§Õ§í      */

        strcat(ASS_CARD._BUFCARD.OPERAND,   /*           §Ü§à§Þ§Ñ§ß§Õ§í      */
          FORMT[0]);

        ASS_CARD._BUFCARD.OPERAND[strlen    /*              §Ú         */
        (ASS_CARD._BUFCARD.OPERAND)] = ' ';

        memcpy(ASS_CARD._BUFCARD.COMM,      /* §á§à§ã§ä§â§à§é§ß§í§Û §Ü§à§Þ§Ö§ß§ä§Ñ§â§Ú§Û  */
          "Generate value of arithmetic express",
          37);
        ZKARD();                             /* §Ù§Ñ§á§à§Þ§ß§Ú§ä§î §à§á§Ö§â§Ñ§è§Ú§ð     */
        /* §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ  §Ú          */
        return 0;                             /* §Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §á§â§à§Ô§â§Ñ§Þ§Þ§å    */
      }
      else if (SYM[i].TYPE == 'b') //Li: todo DEC FIXED 
      {
        ZKARD2("", " CVB", "@RRAB, @BUF", "Convert to binary.");
        ZKARD2("", " STH", "@RRAB, B", "Store Halfword.");
        is_cvb = true;
        return 0;
      }

      else                                    /* §Ö§ã§Ý§Ú §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â §ß§Ö  */
                /* §Ú§Þ§Ö§Ö§ä §ä§Ú§á bin fixed,§ä§à:*/
        return 3;                              /* §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §ã §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú-*/
      /* §Ü§à§Û §à§ê§Ú§Ò§Ü§Ú             */
    }
  }
  return 4;                                       /* §Ö§ã§Ý§Ú §Ú§Õ§Ö§ß§ä§Ú§æ§Ú§Ü§Ñ§ä§à§â §â§Ñ- */
  /* §ß§Ö§Ö §ß§Ö §à§á§â§Ö§Õ§Ö§Ý§Ö§ß §é§Ö§â§Ö§Ù */
  /* §±§­1-§à§á§Ö§â§Ñ§ä§à§â DCL,§ä§à §Ù§Ñ-*/
  /* §Ó§Ö§â§ê§Ö§ß§Ú§Ö §ã §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§à§Û*/
  /* §à§ê§Ú§Ò§Ü§Ú                 */

}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ OPR §ß§Ñ §Ó§ä§à-*/
              /* §â§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* OPR - "§à§á§Ö§â§Ñ§ä.§±§­1-PROC"*/

              /* §á§â§à§Ô§â§Ñ§Þ§Þ§Ñ    §æ§à§â§Þ§Ú§â§å§Ö§ä */
              /* §á§â§à§Ý§à§Ô §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Ô§à*/
              /* §ï§Ü§Ó§Ú§Ó§Ñ§Ý§Ö§ß§ä§Ñ  §Ú§ã§ç§à§Õ§ß§à§Û  */
              /* §±§­1-§á§â§à§Ô§â§Ñ§Þ§Þ§í          */
int OPR2()
{
  //fprintf(fp_out, "%s\n", "OPR2");


  char i = 0;
  FORM();                                        /* §æ§à§â§Þ§Ñ§ä§Ú§â§å§Ö§Þ §à§á§Ö§â§Ñ§ä§à§â   */
  /* §±§­1 - "§ß§Ñ§é§Ñ§Ý§à §á§â§à§è§Ö§Õ§å§â-*/
  /* §ß§à§Ô§à §Ò§Ý§à§Ü§Ñ"            */
  while (FORMT[0][i] != '\x0')
    ASS_CARD._BUFCARD.METKA[i++] = FORMT[0][i];  /* §ß§å§Ý§Ö§Ó§à§Û §ä§Ö§â§Þ §Ú§ã§á§à§Ý§î§Ù§å§Ö§Þ*/
  /* §Ü§Ñ§Ü §Þ§Ö§ä§Ü§å §Ó START-§á§ã§Ö§Ó-*/
  /* §Õ§à§à§á§Ö§â§Ñ§è§Ú§Ú §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ  */

  memcpy(ASS_CARD._BUFCARD.OPERAC, "START", 5);/* §Õ§à§ã§ä§â§Ñ§Ú§Ó§Ñ§Ö§Þ §Ü§à§Õ §Ú §à§á§Ö- */
  memcpy(ASS_CARD._BUFCARD.OPERAND, "0", 1);   /* §â§Ñ§ß§Õ§í  §Ó  START-§á§ã§Ö§Ó§Õ§à-*/
  memcpy(ASS_CARD._BUFCARD.COMM,                /* §à§á§Ö§â§Ñ§è§Ú§Ú §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ    */
    "Program starts", 16);
  ZKARD();                                       /* §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§Ö§Þ §Ü§Ñ§â§ä§å §¡§ã§ã§Ö§Þ-*/
  /* §Ò§Ý§Ö§â§Ñ                  */

  memcpy(ASS_CARD._BUFCARD.OPERAC, "BALR", 4); /* §æ§à§â§Þ§Ú§â§å§Ö§Þ BALR-§à§á§Ö§â§Ñ§è§Ú§ð*/
  memcpy(ASS_CARD._BUFCARD.OPERAND,             /* §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ             */
    "@RBASE,0", 8);
  memcpy(ASS_CARD._BUFCARD.COMM,
    "Load base register", 22);
  ZKARD();                                       /* §Ú §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§Ö§Þ §Ö§Ö        */

  memcpy(ASS_CARD._BUFCARD.OPERAC, "USING", 5);/* §æ§à§â§Þ§Ú§â§å§Ö§Þ USING-§á§ã§Ö§Ó§Õ§à-*/
  memcpy(ASS_CARD._BUFCARD.OPERAND,             /* §à§á§Ö§â§Ñ§è§Ú§ð §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§Ñ    */
    "*,@RBASE", 8);
  memcpy(ASS_CARD._BUFCARD.COMM,
    "Set base register", 23);
  ZKARD();                                       /* §Ú §Ù§Ñ§á§à§Þ§Ú§ß§Ñ§Ö§Þ §Ö§Ö        */

  return 0;                                       /* §Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §á§à§Õ§á§â§à§Ô§â§Ñ§Þ§Þ§å */
}

int write_to_ASSTXT() {
  FILE* fp;                                       /*§ß§Ñ§Ò§à§â §â§Ñ§Ò§à§é§Ú§ç §á§Ö§â§Ö§Þ§Ö§ß§ß§í§ç*/

  strcat(NFIL, "ass");                        /*§ã§æ§à§â§Þ§Ú§â§à§Ó§Ñ§ä§î §Ú§Þ§ñ §Ó§í§ç§à§Õ§ß§à§Ô§à §æ§Ñ§Û§Ý§Ñ*/

  if ((fp = fopen(NFIL, "wb")) == NULL)     /*§á§â§Ú §ß§Ö§å§Õ§Ñ§é§ß.§à§ä§Ü§â§í§ä.§æ-§Ý§Ñ */
    return 7;                                    /* §ã§à§à§Ò§ë§Ö§ß§Ú§Ö §à§Ò §à§ê§Ú§Ò§Ü§Ö    */
  else                                            /*§Ú§ß§Ñ§é§Ö:                  */
    fwrite(ASSTXT, 80, IASSTXT, fp);            /* §æ§à§â§Þ§Ú§â§å§Ö§Þ §ä§Ö§Ý§à §à§Ò.§æ§Ñ§Û§Ý§Ñ*/
  fclose(fp);
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ PRO §ß§Ñ §Ó§ä§à-*/
              /* §â§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* PRO - "§á§â§à§Ô§â§Ñ§Þ§Þ§Ñ"      */

int PRO2()                                       /*§á§â§à§Ô§â.§æ§à§â§Þ§Ú§â§å§Ö§ä §Ó§í§ç§à§Õ§ß§à§Û*/
{                                                /*§æ§Ñ§Û§Ý                    */

  //FILE* fp;                                       /*§ß§Ñ§Ò§à§â §â§Ñ§Ò§à§é§Ú§ç §á§Ö§â§Ö§Þ§Ö§ß§ß§í§ç*/

  //strcat(NFIL, "ass");                        /*§ã§æ§à§â§Þ§Ú§â§à§Ó§Ñ§ä§î §Ú§Þ§ñ §Ó§í§ç§à§Õ§ß§à§Ô§à §æ§Ñ§Û§Ý§Ñ*/  

  //if ((fp = fopen(NFIL, "wb")) == NULL)     /*§á§â§Ú §ß§Ö§å§Õ§Ñ§é§ß.§à§ä§Ü§â§í§ä.§æ-§Ý§Ñ */
  //  return (7);                                    /* §ã§à§à§Ò§ë§Ö§ß§Ú§Ö §à§Ò §à§ê§Ú§Ò§Ü§Ö    */
  //else                                            /*§Ú§ß§Ñ§é§Ö:                  */
  //  fwrite(ASSTXT, 80, IASSTXT, fp);            /* §æ§à§â§Þ§Ú§â§å§Ö§Þ §ä§Ö§Ý§à §à§Ò.§æ§Ñ§Û§Ý§Ñ*/
  //fclose(fp);                                  /*§Ù§Ñ§Ü§â§í§Ó§Ñ§Ö§Þ §à§Ò'§Ö§Ü§ä§ß§í§Û §æ§Ñ§Û§Ý*/              

  //return (0);                                   /*§Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §á§à§Ý§Õ§á§â§à§Ô§â§Ñ§Þ§Þ§å */

  return write_to_ASSTXT();
}




/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ RZR §ß§Ñ §Ó§ä§à-*/
              /* §â§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* RZR - "§â§Ñ§Ù§â§ñ§Õ§ß§à§ã§ä§î"    */

int RZR2() // Li:?
{
  //char RAB[20];
  //char i = 0;
  //FORM();
  //if (is_fv == 't')
  //  return 0;
  //for (i = 0; i < ISYM; i++)
  //{
  //  if (isalpha(SYM[i].NAME[0]))
  //  {
  //    if (SYM[i].TYPE == 'b')
  //    {
  //      char op[] = "BL";
  //      strcat(op, SYM[i].RAZR);
  //      ZKARD2(SYM[i].NAME, "DS", op, "Memory allocation");
  //      is_fv = 't';
  //    }
  //  }
  //}
  return 0;

}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ TEL §ß§Ñ §Ó§ä§à-*/
              /* §â§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* TEL - "§ä§Ö§Ý§à §á§â§à§Ô§â§Ñ§Þ§Þ§í" */

int TEL2()
{
  return 0;
}

/*..........................................................................*/

              /* §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ      */
              /* §ã§Ö§Þ§Ñ§ß§ä§Ú§é. §Ó§í§é§Ú§ã§Ý§Ö§ß§Ú§ñ   */
              /* §ß§Ö§ä§Ö§â§Þ§Ú§ß§Ñ§Ý§Ñ ZNK §ß§Ñ §Ó§ä§à-*/
              /* §â§à§Þ §á§â§à§ç§à§Õ§Ö.   §©§Õ§Ö§ã§î   */
              /* ZNK - "§Ù§ß§Ñ§Ü §à§á§Ö§â§Ñ§è§Ú§Ú"  */

int ZNK2()
{
  return 0;
}

/*..........................................................................*/
/*****************************************
 * §¯ §¡ §¹ §¡ §­ §°  §à§Ò§â§Ñ§Ò§à§ä§Ü§Ú §Ú§ã§ç§à§Õ§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ
 *****************************************/
 /*..........................................................................*/



/*..........................................................................*/
/* ½«·ÖÎöºóµÄÔ´´úÂë½á¹¹×ª»»Îª»úÆ÷´úÂë»òÖÐ¼ä±íÊ¾´úÂë¡£·ÖÁ½ÌË½øÐÐ£¬Ö»ÔÚµÚ¶þÌËÐ´³öÖÐ¼ä´úÂë¡£ */
              /*  §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ     */
              /* §å§á§â§Ñ§Ó§Ý§Ö§ß§Ú§ñ §Ñ§Ò§ã§ä§â§Ñ§Ü§ä§ß§à§Û */
              /* §¿§£§®  -  §ã§Ö§Þ§Ñ§ß§ä§Ú§é§Ö§ã§Ü§à§Ô§à */
              /* §Ó§í§é§Ú§ã§Ý§Ú§ä§Ö§Ý§ñ, §Ú§ß§ä§Ö§â§á§â§Ö- */
              /* §ä§Ú§â§å§ð§ë§Ö§Ô§à §Ñ§Ò§ã§ä§â§Ñ§Ü§ä§ß§å§ð  */
              /* §á§â§à§Ô§â§Ñ§Þ§Þ§å, §ã§æ§à§â§Þ§Ú§â§à§Ó§Ñ§ß-*/
              /* §ß§å§ð §ã§Ú§ß§ä§Ñ§Ü§ã§Ú§é§Ö§ã§Ü§Ú§Þ §Ñ§ß§Ñ-*/
              /* §Ý§Ú§Ù§Ñ§ä§à§â§à§Þ §Ó §ã§ä§Ö§Ü§Ö §Õ§à§ã- */
              /* §ä§Ú§Ô§ß§å§ä§í§ç §è§Ö§Ý§Ö§Û.        */

              /* §³§å§ä§î §Ñ§Ý§Ô§à§â§Ú§ä§Þ§Ñ §å§á§â§Ñ§Ó§Ý§Ö-*/
              /*§ß§Ú§ñ  §Ó  §á§à§ã§Ý§Ö§Õ§à§Ó§Ñ§ä§Ö§Ý§î§ß§à§Û*/
int gen_COD() /*§Ú§ß§ä§Ö§â§á§â§Ö§ä§Ñ§è§Ú§Ú §ã§ä§â§à§Ü §ã§ä§Ö-*/
{             /*§Ü§Ñ §Õ§à§ã§ä§Ú§Ø§Ö§ß§Ú§Û  §Ó §ß§Ñ§á§â§Ñ§Ó-*/
  int NOSH;    /*§Ý§Ö§ß§Ú§Ú §à§ä §Õ§ß§Ñ §Ü §Ó§Ö§â§ê§Ú§ß§Ö. */
  //fprintf(fp_out, "%s\n", "---> int gen_COD()");
  //fflush(fp_out);

  int (*FUN[NNETRM][2]) () =                    /*§±§â§Ú §ï§ä§à§Þ §Ü§Ñ§Ø§Õ§Ñ§ñ §ã§ä§â§à§Ü§Ñ  */
  {                                              /*§Ó§à§ã§á§â§Ú§ß§Ú§Þ§Ñ§Ö§ä§ã§ñ §Ü§Ñ§Ü §Ü§à§Þ§Ñ-*/
    {/*    1  */    AVI1, AVI2 },                /*§ß§Õ§Ñ §Ñ§Ò§ã§ä§â§Ñ§Ü§ä§ß§à§Û §¿§£§® §ã§à  */
    {/*    2  */    BUK1, BUK2 },                /*§ã§Ý§Ö§Õ§å§ð§ë§Ú§Þ§Ú §á§à§Ý§ñ§Þ§Ú:      */
    {/*    3  */    CIF1, CIF2 },
    {/*    4  */    IDE1, IDE2 },		  /* - DST.DST1 - §Ü§à§Õ §à§á§Ö§â§Ñ§è§Ú§Ú*/
    {/*    5  */    IPE1, IPE2 },
    {/*    6  */    IPR1, IPR2 },
    {/*    7  */    LIT1, LIT2 },     /* - DST.DST2 - §Ý§Ö§Ó§Ñ§ñ §Ô§â§Ñ-*/
    {/*    8  */    MAN1, MAN2 },		  /*§ß§Ú§è§Ñ §Ú§ß§ä§Ö§â§á§â§Ö§ä§Ú§â§å§Ö§Þ§à§Ô§à  */
    {/*    9  */    ODC1, ODC2 },		  /*§æ§â§Ñ§Ô§Þ§Ö§ß§ä§Ñ §Ú§ã§ç.§ä§Ö§Ü§ã§ä§Ñ;   */
    {/*   10  */    OEN1, OEN2 },
    {/*   11  */    OPA1, OPA2 },		  /* - DST.DST4 -§á§â§Ñ§Ó§Ñ§ñ §Ô§â§Ñ-*/
    {/*   12  */    OPR1, OPR2 },		  /*§ß§Ú§è§Ñ §Ú§ß§ä§Ö§â§á§â§Ö§ä§Ú§â§å§Ö§Þ§à§Ô§à  */
    {/*   13  */    PRO1, PRO2 },		  /*§æ§â§Ñ§Ô§Þ§Ö§ß§ä§Ñ §Ú§ã§ç.§ä§Ö§Ü§ã§ä§Ñ.   */
    {/*   14  */    RZR1, RZR2 },
    {/*   15  */    TEL1, TEL2 },
    {/*   16  */    ZNK1, ZNK2 },
    {/*   17  */    DCF1, DCF2 }
  };

  //fprintf(fp_out, ">>>>>>>>>>>>>>>>>>>>> %s <<<<<<<<<<<<<<<<<<<<<\n", "Pass1 of semantic calculation");    
  for (I2 = 0; I2 < L; I2++) {
    //fprintf(fp_out, ">>>> %d/%d Operation code: %s\n", I2, L, DST[I2].DST1);
    //print_DST(); // Li
    int tmp = 0;
    tmp = idx_of_VXOD(DST[I2].DST1, 3);
    //fprintf(fp_out, 
      //">> %s, operation code: %s, get from table: %d\n", "idx_of_VXOD", 
      //DST[I2].DST1, tmp);
    fflush(fp_out);

    NOSH = FUN[tmp][0]();
    if (NOSH != 0) {
      return NOSH;
    }

  }

  //fprintf(fp_out, ">>>>>>>>>>>>>>>>>>>>> %s <<<<<<<<<<<<<<<<<<<<<\n", "Pass2 of semantic calculation");
  fflush(fp_out);
  for (I2 = 0; I2 < L; I2++) {

    int tmp = 0;
    tmp = idx_of_VXOD(DST[I2].DST1, 3);
    //fprintf(fp_out, ">>>> %d/%d Operation code: %s\n", I2, L, DST[I2].DST1);
    //print_DST(); // Li
    //fprintf(fp_out, ">> %s, operation code: %s, get from table: %d\n", "idx_of_VXOD", DST[I2].DST1, tmp);
    fflush(fp_out);

    NOSH = FUN[tmp][1]();
    if (NOSH != 0) {
      return NOSH;
    }

  }
  print_ASSTXT_to_file();
  // ---------- Li --------------

  return 0;    /* §å§ã§á§Ö§ê§ß§à§Ö §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §á§â§à§Ô§â§Ñ§Þ§Þ§í  */
}



/*..........................................................................*/

              /*  §á §â §à §Ô §â §Ñ §Þ §Þ §Ñ,    */
              /* §à§â§Ô§Ñ§ß§Ú§Ù§å§ð§ë§Ñ§ñ §á§à§ã§Ý§Ö§Õ§à§Ó§Ñ-*/
              /* §ä§Ö§Ý§î§ß§å§ð §à§Ò§â§Ñ§Ò§à§ä§Ü§å §Ú§ã-  */
              /* §ç§à§Õ§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ:        */
              /* - §Ý§Ö§Ü§ã§Ú§é.§Ñ§ß§Ñ§Ý§Ú§Ù§Ñ§ä§à§â§à§Þ; */
              /* - §ã§Ú§ß§ä§Ñ§Ü§ã§Ú§é.§Ñ§ß§Ñ§Ý§Ú§Ù§Ñ§ä.; */
              /* - §ã§Ö§Þ§Ñ§ß§ä§Ú§é.§Ó§í§é§Ú§ã§Ý§Ú§ä§Ö§Ý§Ö§Þ*/
int main(int argc, char** argv)
{                                                /* §â§Ñ§Ò§à§é§Ú§Ö §á§Ö§â§Ö§Þ§Ö§ß§ß§í§Ö:    */
  FILE* fp;                                      /* - §å§Ü§Ñ§Ù§Ñ§ä§Ö§Ý§î §ß§Ñ §æ§Ñ§Û§Ý;   */
  fp_out = fopen("log.txt", "a+");               /* Li: ÓÃÓÚ¶ÁÈ¡debugµÄ½á¹û */
  if (NULL == fp_out)
  {
    printf("open log.txt failed! \n");
    return FILE_NOT_OPEN;
  }
  setbuf(fp_out, NULL);

  print_title_log();

  const char* ptr = "examppl.pli";
  strcpy(NFIL, ptr);

  /* §á§â§à§Ó§Ö§â§Ü§Ñ §ä§Ú§á§Ñ §Ú§ã§ç.§æ§Ñ§Û§Ý§Ñ*/
  if (strcmp(&NFIL[strlen(NFIL) - 3], "pli"))
  {
    printf("%s\n",                              /* §Ó§í§Õ§Ñ§ä§î §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§å §Ú   */
      "Invalid source file type");
    return -1;                                  /* §Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §ä§â§Ñ§ß§ã§Ý§ñ§è§Ú§ð   */
  }
  else
  {                                             /*§á§í§ä§Ñ§Ö§Þ§ã§ñ §à§ä§Ü§â§í§ä§î §æ§Ñ§Û§Ý §Ú */
    if ((fp = fopen(NFIL, "rb")) == NULL)
    {
      printf("%s\n", "File not found");
      return -1;                                /* §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ö §ä§â§Ñ§ß§ã§Ý§ñ§è§Ú§Ú  */
    }
    else
    {
      for (NISXTXT = 0; NISXTXT <= MAXNISXTXT; NISXTXT++) {
        if (!fread(ISXTXT[NISXTXT], 80, 1, fp)) {
          if (feof(fp))                      /* §Ó §Ü§à§ß§è§Ö §æ§Ñ§Û§Ý§Ñ §Ú§Õ§Ö§Þ §ß§Ñ  */
          {
            goto main1;                            /* §Þ§Ö§ä§Ü§å  main1 */
          }
          else
          {
            printf("%s\n", "Error reading source file");
            return -1;
          }
        }
      }

      printf("%s\n", "Text read buffer overflow");
      return -1;
    }
  }

main1:                                            /* §á§à §Ù§Ñ§Ó§Ö§â§ê§Ö§ß§Ú§Ú §é§ä§Ö§ß§Ú§ñ   */
  /* §Ú§ã§ç.§æ§Ñ§Û§Ý§Ñ §æ§à§â§Þ§Ú§â§å§Ö§Þ    */
  fclose(fp);                                 /* §á§â§Ö§æ§Ú§Ü§ã §Ú§Þ§Ö§ß§Ú §Ó§í§ç§à§Õ§ß§à§Ô§à*/
  NFIL[strlen(NFIL) - 3] = '\x0';            /* §¡§ã§ã§Ö§Þ§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Ô§à §æ§Ñ§Û§Ý§Ñ */
  memset(ASS_CARD.BUFCARD, ' ', 80);           /* §é§Ú§ã§ä§Ü§Ñ §Ò§å§æ§Ö§â§Ñ §ã§ä§â§à§Ü§Ú   */
  /* §Ó§í§ç§à§Õ§ß§à§Ô§à §Ñ§ã§ã§Ö§Þ§Ò§Ý§Ö§â§à§Ó§ã§Ü§à§Ô§à §æ§Ñ§Û§Ý§Ñ */

  compress_ISXTXT();                             /* §Ý§Ö§Ü§ã§Ú§é§Ö§ã§Ü§Ú§Û §Ñ§ß§Ñ§Ý§Ú§Ù §Ú§ã§ç§à§Õ§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ*/
  build_TPR();                                   /* §á§à§ã§ä§â§à§Ö§ß§Ú§Ö §Þ§Ñ§ä§â§Ú§è§í §á§â§Ö§Ö§Þ§ß§Ú§Ü§à§Ó */
  int return_sint_ANAL = sint_ANAL();
  if (return_sint_ANAL)                           /* §ã§Ú§ß§ä§Ñ§Ü§ã§Ú§é§Ö§ã§Ü§Ú§Û §Ñ§ß§Ñ§Ý§Ú§Ù  §Ú§ã§ç§à§Õ§ß§à§Ô§à §ä§Ö§Ü§ã§ä§Ñ */
  {
    print_error_code(return_sint_ANAL);
    return -1;                                      /* §Ù§Ñ§Ó§Ö§â§ê§Ñ§Ö§Þ §ä§â§Ñ§ß§ã§Ý§ñ§è§Ú§ð   */
  }
  else                                            /* §Ú§ß§Ñ§é§Ö §Õ§Ö§Ý§Ñ§Ö§Þ           */
  {
    int result_gen_COD = gen_COD();
    if (result_gen_COD == 0) {
      printf("%s\n", "OK!");
      return 0;                                    /* §Ù§Ñ§Ó§Ö§â§ê§Ú§ä§î §ä§â§Ñ§ß§ã§Ý§ñ§è§Ú§ð */
    }
    print_error_message_of_COD(result_gen_COD);
    fclose(fp_out);
  }

  printf("%s\n", "ERROR.");       /* §à§Ò§à§Ò§ë§Ñ§ð§ë§Ñ§ñ §Õ§Ú§Ñ§Ô§ß§à§ã§ä§Ú§Ü§Ñ */
  return -1;
}
/*..........................................................................*/
